<!DOCTYPE html>
<html>

<head>
    <title>Cryptomedic</title>
    <meta charset='utf-8'>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script>
        /* Test if all necessary technologies are present */
        (function () {
            const shouldUpgrade = function () {
                window.location.href = '/static/upgrade.html';
            };

            // Test custom elements
            // Ok since 2018 except Edge
            if (!ShadowRoot || !customElements) {
                shouldUpgrade();
            }

            // Test input[type=date]
            // Ok since 2015 except Safari
            // @See https://stackoverflow.com/a/10199306/1954789
            var input = document.createElement('input');
            input.setAttribute('type', 'date');

            var notADateValue = 'not-a-date';
            input.setAttribute('value', notADateValue);

            if (input.value === notADateValue) {
                shouldUpgrade('input[type=date]');
            }
        })();

    </script>
    <script nomodule>
        /* Test if all necessary technologies are present */
        // Ok since 2019 except Opera mini
        // We need a browser that support modules
        window.location.href = '/static/upgrade.html';
    </script>
    <script>
        // Test cookies
        (function () {
            var cookieEnabled = (navigator.cookieEnabled) ? true : false;

            if (typeof (navigator.cookieEnabled) == 'undefined' && !cookieEnabled) {
                document.cookie = 'testcookie';
                cookieEnabled = (document.cookie.indexOf('testcookie') != -1) ? true : false;
            }
            if (!cookieEnabled) {
                alert('Your cookie are disabled. Please enable them.\nVos cookies sont désactivés. Merci de les activer.');
                console.error('Cookies are disabled');
            }
        })();
    </script>

    <!-- Catch errors -->
    <script src="../build/release_version.js"></script>
</head>

<body ng-app="app_main" ng-controller="ctrl">
    <!--  Navigation bar -->
    <nav class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header" style='width: 100%;'>
                <ul class="nav navbar-nav navbar-right">
                    <li><a id='menu_home' href="#/home" class="navbar-link">
                            <x-restricted restricted-by='application.open'>
                                <img src="../static/img/home.gif" height="20px" />
                                Home
                            </x-restricted>
                        </a>
                    </li>
                    <li><a id='menu_search' href="#/search" class="navbar-link">
                            <x-restricted restricted-by='folder.read'>
                                <img src="../static/img/patientsSearch.gif" height="20px" />
                                Search a patient
                            </x-restricted>
                        </a></li>
                    <li><a id='menu_consults' href="#/reports/consultations" class="navbar-link">
                            <x-restricted restricted-by='planning.execute'>
                                <img src="../static/img/consultOfDay.gif" height="20px" />
                                Consults of the day
                            </x-restricted>
                        </a></li>
                    <li>
                        <x-login-status></x-login-status>
                    </li>
                    <li><a id='menu_users' href='#/users'>
                            <x-restricted restricted-by='users.manage'>
                                <img src="../static/img/users.png" height="20px" />
                                Users
                            </x-restricted>
                        </a></li>
                    <li><a id='menu_reports' href="#/reports" class="navbar-link">
                            <x-restricted restricted-by='reports.execute'>
                                <img src="../static/img/reports.gif" height="20px" />
                                Reports
                            </x-restricted>
                        </a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class='container-fluid' id='main_content'>
        <!--  Pending screen -->
        <cryptomedic-data-service id='dataService'>
            <div>
                <div ng-view></div>
            </div>
        </cryptomedic-data-service>
    </div>
</body>

</html>