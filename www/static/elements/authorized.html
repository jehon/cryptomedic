<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module name="jh-authorized">
  <template>
    <span id='translating' hidden$="[[!isAuthorized(value, authorizedList, inversed)]]">
      <content></content>
    </span>
  </template>

  <script>
    /* global jQuery */
    /* exported setAuthorizedObject */

    let setAuthorizedCallback = jQuery.Callbacks("memory");

    let JHAuthorized = {
      setAuthorizedList: function(list = []) {
        setAuthorizedCallback.fire(list);
      }
    }

    Polymer({
      is: 'jh-authorized',

      properties: {
        value: {
          type:               String,
          readonly:           true,
          notify:             true,
          value:              "application.open"
        },
        inversed: {
          type:               Boolean,
          readonly:           true,
          notify:             true,
          value:              false
        },
      },

      ready: function() {
        this.authorizedList = [];
        setAuthorizedCallback.add((list) => this.setAuthorizedList(list));
      },

      setAuthorizedList: function(authorizedList) {
        // Set it in two steps, to enable trigger of update
        // this.authorizedList = null;
        this.authorizedList = authorizedList;
      },

      isAuthorized(value, authorizedList = [], inversed = false) {
        if (inversed) {
          return !this.isAuthorized(value, authorizedList, false);
        }
        if (authorizedList == null) {
          return false;
        }
        return authorizedList.indexOf(value) >= 0;
      }
    });
  </script>
</dom-module>
