<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module name="jh-authorized">
  <template>
    <span id='translating' hidden$="[[!isAuthorized(value, authorizedList, inversed)]]">
      <content></content>
    </span>
  </template>

  <script>
    /* exported setAuthorizedObject */

    function setAuthorizedObject(authorizedObject = null) {
      // console.log("setAuthorizedObject: ", authorizedObject);
      let list = (authorizedObject ? Object.keys(authorizedObject) : []);
      for(let el of document.getElementsByTagName("jh-authorized")) {
        el.setAuthorizedList(list);
      }
    }

    Polymer({
      is: 'jh-authorized',

      // https://www.polymer-project.org/1.0/docs/devguide/properties
      properties: {
        value: {
          type:               String,
          readonly:           true,
          value:              "application.open"
        },
        inversed: {
          type:               Boolean,
          readonly:           true
        }
      },

      setAuthorizedList: function(authorizedList) {
        // Set it in two steps, to enable trigger of update
        this.authorizedList = null;
        this.authorizedList = authorizedList;
      },

      isAuthorized(value, authorizedList, inversed) {
        if (inversed) {
          console.log("inversed test: ", value);
          return !this.isAuthorized(value, authorizedList, false);
        }
        if (authorizedList == null) {
          return false;
        }
        return authorizedList.indexOf(value) >= 0;
      }
    });
  </script>
</dom-module>
