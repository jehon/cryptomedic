!function(n){function t(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var e={};return t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){"use strict";function r(n,t){postMessage({name:n,data:t})}function o(n){var t=a.resolve();return n.reset&&(t=t.then(function(){return console.info("Worker: resetting the database patients"),p.clear().then(function(){p.updateCheckpoint("")})})),n.data?t=t.then(function(){return p.bulkUpdate(n.data,function(n){r("folder",n)}).then(function(){n.isfinal?r("progress",{isfinal:!0}):r("progress",{isfinal:!1,remaining:parseInt(n.remaining),done:parseInt(n.data.length)})},function(n){throw console.error("Error in bulk insert",n),n})}):r("progress",{isfinal:!0}),t}function i(){return v&&clearTimeout(v),y=!1,v=setTimeout(c,36e5),a.resolve()}function u(){return v&&(clearTimeout(v),v=!1),y=!0,a.resolve()}function c(){u().then(function(){return p.getSetting("checkpoint")}).then(function(n){return(0,d["default"])("sync",{},{cp:n})}).then(function(n){return null==n?(console.warn("null result: unauthenticated?"),null):o(n._offline)})["catch"](function(n){r("error",n)}).then(i,i)}var a=e(10)["default"],s=e(18)["default"],f=e(27),l=s(f),h=e(28),d=s(h),p=(0,l["default"])(),v=null,y=!1;onmessage=function(n){var t=n.data.name,e=n.data.data;switch(t){case"init":return c();case"sync":return c();case"resync":return p.updateCheckpoint(!1),c();default:return console.error("unkown message: "+t,e)}}},function(n,t,e){var r=e(49)("wks"),o=e(57),i=e(2).Symbol;n.exports=function(n){return r[n]||(r[n]=i&&i[n]||(i||o)("Symbol."+n))}},function(n,t){var e=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(n,t){var e=n.exports={version:"1.2.6"};"number"==typeof __e&&(__e=e)},function(n,t){var e=Object;n.exports={create:e.create,getProto:e.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:e.getOwnPropertyDescriptor,setDesc:e.defineProperty,setDescs:e.defineProperties,getKeys:e.keys,getNames:e.getOwnPropertyNames,getSymbols:e.getOwnPropertySymbols,each:[].forEach}},function(n,t,e){var r=e(9);n.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(n,t,e){var r=e(11);n.exports=function(n,t,e){if(r(n),void 0===t)return n;switch(e){case 1:return function(e){return n.call(t,e)};case 2:return function(e,r){return n.call(t,e,r)};case 3:return function(e,r,o){return n.call(t,e,r,o)}}return function(){return n.apply(t,arguments)}}},function(n,t){n.exports={}},function(n,t){var e={}.toString;n.exports=function(n){return e.call(n).slice(8,-1)}},function(n,t){n.exports=function(n){return"object"==typeof n?null!==n:"function"==typeof n}},function(n,t,e){n.exports={"default":e(31),__esModule:!0}},function(n,t){n.exports=function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!");return n}},function(n,t){n.exports=function(n){if(void 0==n)throw TypeError("Can't call method on  "+n);return n}},function(n,t,e){n.exports=!e(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(n,t,e){var r=e(2),o=e(3),i=e(6),u="prototype",c=function(n,t,e){var a,s,f,l=n&c.F,h=n&c.G,d=n&c.S,p=n&c.P,v=n&c.B,y=n&c.W,m=h?o:o[t]||(o[t]={}),g=h?r:d?r[t]:(r[t]||{})[u];h&&(e=t);for(a in e)s=!l&&g&&a in g,s&&a in m||(f=s?g[a]:e[a],m[a]=h&&"function"!=typeof g[a]?e[a]:v&&s?i(f,r):y&&g[a]==f?function(n){var t=function(t){return this instanceof n?new n(t):n(t)};return t[u]=n[u],t}(f):p&&"function"==typeof f?i(Function.call,f):f,p&&((m[u]||(m[u]={}))[a]=f))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,n.exports=c},function(n,t,e){var r=e(4),o=e(24);n.exports=e(13)?function(n,t,e){return r.setDesc(n,t,o(1,e))}:function(n,t,e){return n[t]=e,n}},function(n,t,e){var r=e(4).setDesc,o=e(21),i=e(1)("toStringTag");n.exports=function(n,t,e){n&&!o(n=e?n:n.prototype,i)&&r(n,i,{configurable:!0,value:t})}},function(n,t,e){(function(n,r){function o(n,t){this._id=n,this._clearFn=t}var i=e(66).nextTick,u=Function.prototype.apply,c=Array.prototype.slice,a={},s=0;t.setTimeout=function(){return new o(u.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new o(u.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(n){n.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},t.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},t._unrefActive=t.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},t))},t.setImmediate="function"==typeof n?n:function(n){var e=s++,r=arguments.length<2?!1:c.call(arguments,1);return a[e]=!0,i(function(){a[e]&&(r?n.apply(null,r):n.call(null),t.clearImmediate(e))}),e},t.clearImmediate="function"==typeof r?r:function(n){delete a[n]}}).call(t,e(17).setImmediate,e(17).clearImmediate)},function(n,t){"use strict";t["default"]=function(n){return n&&n.__esModule?n:{"default":n}},t.__esModule=!0},function(n,t,e){var r=e(8),o=e(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());n.exports=function(n){var t,e,u;return void 0===n?"Undefined":null===n?"Null":"string"==typeof(e=(t=Object(n))[o])?e:i?r(t):"Object"==(u=r(t))&&"function"==typeof t.callee?"Arguments":u}},function(n,t){n.exports=function(n){try{return!!n()}catch(t){return!0}}},function(n,t){var e={}.hasOwnProperty;n.exports=function(n,t){return e.call(n,t)}},function(n,t,e){"use strict";var r=e(23),o=e(14),i=e(25),u=e(15),c=e(21),a=e(7),s=e(40),f=e(16),l=e(4).getProto,h=e(1)("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",v="keys",y="values",m=function(){return this};n.exports=function(n,t,e,g,b,_,w){s(e,t,g);var x,k,P=function(n){if(!d&&n in T)return T[n];switch(n){case v:return function(){return new e(this,n)};case y:return function(){return new e(this,n)}}return function(){return new e(this,n)}},S=t+" Iterator",D=b==y,O=!1,T=n.prototype,j=T[h]||T[p]||b&&T[b],E=j||P(b);if(j){var C=l(E.call(new n));f(C,S,!0),!r&&c(T,p)&&u(C,h,m),D&&j.name!==y&&(O=!0,E=function(){return j.call(this)})}if(r&&!w||!d&&!O&&T[h]||u(T,h,E),a[t]=E,a[S]=m,b)if(x={values:D?E:P(y),keys:_?E:P(v),entries:D?P("entries"):E},w)for(k in x)k in T||i(T,k,x[k]);else o(o.P+o.F*(d||O),t,x);return x}},function(n,t){n.exports=!0},function(n,t){n.exports=function(n,t){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:t}}},function(n,t,e){n.exports=e(15)},function(n,t){var e=Math.ceil,r=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?r:e)(n)}},function(n,t,e){"use strict";function r(){function n(n){return h.patients.get(""+n).then(function(t){if(t)return e(t);throw"I say, this patient is not found #"+n})}function t(n,t){return h.patients.where("[mainFile.entryyear+mainFile.entryorder]").equals([""+n,""+t]).toArray(function(r){if(r&&1==r.length)return e(r[0]);throw"I say, reference not found #"+n+"."+t})}function e(n){return n}function r(n){var t="checkpoint";return n===!1?s(t,""):""==n?o.resolve(""):a(t,"").then(function(e){return!e||n>e?s(t,n):e})}function i(n){var t,e;return n._deleted?(t=h.patients["delete"](""+n.id),e=""+n.id):(n.record.id+="",n.record.mainFile.entryyear+="",n.record.mainFile.entryorder+="",t=h.patients.put(n.record),e=n.record),t.then(function(){return r(n.checkpoint)}),t.then(function(){return e})}function u(n,t){var e=o.resolve();for(var r in n)e=e.then(function(e){return new o(function(r,o){i(n[e]).then(function(n){t&&t(n),r()},function(n){o(n)})})}(r));return e}function a(n,t){return h.settings.get(""+n).then(function(n){return n?n.value:t=t||!1})}function s(n,t){return h.settings.put({key:""+n,value:t}).then(function(){return t})}function f(){return h.patients.clear().then(function(){return h.settings.clear()})}function l(){return h.verno}var h=new c["default"]("cryptomedic");return h.version(1).stores({patients:"++id"}),h.version(2).stores({patients:"++id,[mainFile.entryyear+mainFile.entryorder]"}),h.version(3).stores({patients:"++id"}),h.version(4).stores({patients:"++id,[mainFile.entryyear+mainFile.entryorder]"}),h.version(5).upgrade(function(n){n.patients.toCollection().modify(function(n){"number"==typeof n.id&&delete this.value,n.id=""+n.id})}),h.version(6).stores({patients:"++id,[mainFile.entryyear+mainFile.entryorder]",settings:"key"}),h.open(),{getFolder:n,getByReference:t,storeRecord:i,bulkUpdate:u,updateCheckpoint:r,getSetting:a,setSetting:s,clear:f,version:l}}var o=e(10)["default"],i=e(18)["default"];Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r;var u=e(65),c=i(u);n.exports=t["default"]},function(n,t,e){"use strict";function r(n,t,e){if(t=t||{},t.method||(t.method="GET"),t.credentials="include","/"!=n[0]&&(n="/"+location.pathname.split("/")[1]+"/api/v1.0/"+n),e)if("POST"==t.method){var r=new FormData;for(var u in e)r.append(u,e[u]);t.body=r}else if("PUT"==t.method){t.headers||(t.headers={}),t.headers["Content-type"]="application/x-www-form-urlencoded; charset=UTF-8";var c=function(n){return o(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")};t.body=c(e)}else{n+="?";for(var a in e)n=n+encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&"}var s=new Request(n,t);return fetch(s).then(function(n){return n.ok?n.json():i.reject(n.status)})}var o=e(29)["default"],i=e(10)["default"];Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r,n.exports=t["default"]},function(n,t,e){n.exports={"default":e(30),__esModule:!0}},function(n,t,e){e(60),n.exports=e(3).Object.keys},function(n,t,e){e(61),e(63),e(64),e(62),n.exports=e(3).Promise},function(n,t){n.exports=function(){}},function(n,t,e){var r=e(9),o=e(2).document,i=r(o)&&r(o.createElement);n.exports=function(n){return i?o.createElement(n):{}}},function(n,t,e){var r=e(6),o=e(39),i=e(38),u=e(5),c=e(55),a=e(58);n.exports=function(n,t,e,s){var f,l,h,d=a(n),p=r(e,s,t?2:1),v=0;if("function"!=typeof d)throw TypeError(n+" is not iterable!");if(i(d))for(f=c(n.length);f>v;v++)t?p(u(l=n[v])[0],l[1]):p(n[v]);else for(h=d.call(n);!(l=h.next()).done;)o(h,p,l.value,t)}},function(n,t,e){n.exports=e(2).document&&document.documentElement},function(n,t){n.exports=function(n,t,e){var r=void 0===e;switch(t.length){case 0:return r?n():n.call(e);case 1:return r?n(t[0]):n.call(e,t[0]);case 2:return r?n(t[0],t[1]):n.call(e,t[0],t[1]);case 3:return r?n(t[0],t[1],t[2]):n.call(e,t[0],t[1],t[2]);case 4:return r?n(t[0],t[1],t[2],t[3]):n.call(e,t[0],t[1],t[2],t[3])}return n.apply(e,t)}},function(n,t,e){var r=e(8);n.exports=Object("z").propertyIsEnumerable(0)?Object:function(n){return"String"==r(n)?n.split(""):Object(n)}},function(n,t,e){var r=e(7),o=e(1)("iterator"),i=Array.prototype;n.exports=function(n){return void 0!==n&&(r.Array===n||i[o]===n)}},function(n,t,e){var r=e(5);n.exports=function(n,t,e,o){try{return o?t(r(e)[0],e[1]):t(e)}catch(i){var u=n["return"];throw void 0!==u&&r(u.call(n)),i}}},function(n,t,e){"use strict";var r=e(4),o=e(24),i=e(16),u={};e(15)(u,e(1)("iterator"),function(){return this}),n.exports=function(n,t,e){n.prototype=r.create(u,{next:o(1,e)}),i(n,t+" Iterator")}},function(n,t,e){var r=e(1)("iterator"),o=!1;try{var i=[7][r]();i["return"]=function(){o=!0},Array.from(i,function(){throw 2})}catch(u){}n.exports=function(n,t){if(!t&&!o)return!1;var e=!1;try{var i=[7],u=i[r]();u.next=function(){e=!0},i[r]=function(){return u},n(i)}catch(c){}return e}},function(n,t){n.exports=function(n,t){return{value:t,done:!!n}}},function(n,t,e){var r,o,i,u=e(2),c=e(53).set,a=u.MutationObserver||u.WebKitMutationObserver,s=u.process,f=u.Promise,l="process"==e(8)(s),h=function(){var n,t,e;for(l&&(n=s.domain)&&(s.domain=null,n.exit());r;)t=r.domain,e=r.fn,t&&t.enter(),e(),t&&t.exit(),r=r.next;o=void 0,n&&n.enter()};if(l)i=function(){s.nextTick(h)};else if(a){var d=1,p=document.createTextNode("");new a(h).observe(p,{characterData:!0}),i=function(){p.data=d=-d}}else i=f&&f.resolve?function(){f.resolve().then(h)}:function(){c.call(u,h)};n.exports=function(n){var t={fn:n,next:void 0,domain:l&&s.domain};o&&(o.next=t),r||(r=t,i()),o=t}},function(n,t,e){var r=e(14),o=e(3),i=e(20);n.exports=function(n,t){var e=(o.Object||{})[n]||Object[n],u={};u[n]=t(e),r(r.S+r.F*i(function(){e(1)}),"Object",u)}},function(n,t,e){var r=e(25);n.exports=function(n,t){for(var e in t)r(n,e,t[e]);return n}},function(n,t){n.exports=Object.is||function(n,t){return n===t?0!==n||1/n===1/t:n!=n&&t!=t}},function(n,t,e){var r=e(4).getDesc,o=e(9),i=e(5),u=function(n,t){if(i(n),!o(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};n.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(n,t,o){try{o=e(6)(Function.call,r(Object.prototype,"__proto__").set,2),o(n,[]),t=!(n instanceof Array)}catch(i){t=!0}return function(n,e){return u(n,e),t?n.__proto__=e:o(n,e),n}}({},!1):void 0),check:u}},function(n,t,e){"use strict";var r=e(3),o=e(4),i=e(13),u=e(1)("species");n.exports=function(n){var t=r[n];i&&t&&!t[u]&&o.setDesc(t,u,{configurable:!0,get:function(){return this}})}},function(n,t,e){var r=e(2),o="__core-js_shared__",i=r[o]||(r[o]={});n.exports=function(n){return i[n]||(i[n]={})}},function(n,t,e){var r=e(5),o=e(11),i=e(1)("species");n.exports=function(n,t){var e,u=r(n).constructor;return void 0===u||void 0==(e=r(u)[i])?t:o(e)}},function(n,t){n.exports=function(n,t,e){if(!(n instanceof t))throw TypeError(e+": use the 'new' operator!");return n}},function(n,t,e){var r=e(26),o=e(12);n.exports=function(n){return function(t,e){var i,u,c=String(o(t)),a=r(e),s=c.length;return 0>a||a>=s?n?"":void 0:(i=c.charCodeAt(a),55296>i||i>56319||a+1===s||(u=c.charCodeAt(a+1))<56320||u>57343?n?c.charAt(a):i:n?c.slice(a,a+2):(i-55296<<10)+(u-56320)+65536)}}},function(n,t,e){var r,o,i,u=e(6),c=e(36),a=e(35),s=e(33),f=e(2),l=f.process,h=f.setImmediate,d=f.clearImmediate,p=f.MessageChannel,v=0,y={},m="onreadystatechange",g=function(){var n=+this;if(y.hasOwnProperty(n)){var t=y[n];delete y[n],t()}},b=function(n){g.call(n.data)};h&&d||(h=function(n){for(var t=[],e=1;arguments.length>e;)t.push(arguments[e++]);return y[++v]=function(){c("function"==typeof n?n:Function(n),t)},r(v),v},d=function(n){delete y[n]},"process"==e(8)(l)?r=function(n){l.nextTick(u(g,n,1))}:p?(o=new p,i=o.port2,o.port1.onmessage=b,r=u(i.postMessage,i,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(n){f.postMessage(n+"","*")},f.addEventListener("message",b,!1)):r=m in s("script")?function(n){a.appendChild(s("script"))[m]=function(){a.removeChild(this),g.call(n)}}:function(n){setTimeout(u(g,n,1),0)}),n.exports={set:h,clear:d}},function(n,t,e){var r=e(37),o=e(12);n.exports=function(n){return r(o(n))}},function(n,t,e){var r=e(26),o=Math.min;n.exports=function(n){return n>0?o(r(n),9007199254740991):0}},function(n,t,e){var r=e(12);n.exports=function(n){return Object(r(n))}},function(n,t){var e=0,r=Math.random();n.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++e+r).toString(36))}},function(n,t,e){var r=e(19),o=e(1)("iterator"),i=e(7);n.exports=e(3).getIteratorMethod=function(n){return void 0!=n?n[o]||n["@@iterator"]||i[r(n)]:void 0}},function(n,t,e){"use strict";var r=e(32),o=e(42),i=e(7),u=e(54);n.exports=e(22)(Array,"Array",function(n,t){this._t=u(n),this._i=0,this._k=t},function(){var n=this._t,t=this._k,e=this._i++;return!n||e>=n.length?(this._t=void 0,o(1)):"keys"==t?o(0,e):"values"==t?o(0,n[e]):o(0,[e,n[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(n,t,e){var r=e(56);e(44)("keys",function(n){return function(t){return n(r(t))}})},function(n,t){},function(n,t,e){"use strict";var r,o=e(4),i=e(23),u=e(2),c=e(6),a=e(19),s=e(14),f=e(9),l=e(5),h=e(11),d=e(51),p=e(34),v=e(47).set,y=e(46),m=e(1)("species"),g=e(50),b=e(43),_="Promise",w=u.process,x="process"==a(w),k=u[_],P=function(n){var t=new k(function(){});return n&&(t.constructor=Object),k.resolve(t)===t},S=function(){function n(t){var e=new k(t);return v(e,n.prototype),e}var t=!1;try{if(t=k&&k.resolve&&P(),v(n,k),n.prototype=o.create(k.prototype,{constructor:{value:n}}),n.resolve(5).then(function(){})instanceof n||(t=!1),t&&e(13)){var r=!1;k.resolve(o.setDesc({},"then",{get:function(){r=!0}})),t=r}}catch(i){t=!1}return t}(),D=function(n,t){return i&&n===k&&t===r?!0:y(n,t)},O=function(n){var t=l(n)[m];return void 0!=t?t:n},T=function(n){var t;return f(n)&&"function"==typeof(t=n.then)?t:!1},j=function(n){var t,e;this.promise=new n(function(n,r){if(void 0!==t||void 0!==e)throw TypeError("Bad Promise constructor");t=n,e=r}),this.resolve=h(t),this.reject=h(e)},E=function(n){try{n()}catch(t){return{error:t}}},C=function(n,t){if(!n.n){n.n=!0;var e=n.c;b(function(){for(var r=n.v,o=1==n.s,i=0,c=function(t){var e,i,u=o?t.ok:t.fail,c=t.resolve,a=t.reject;try{u?(o||(n.h=!0),e=u===!0?r:u(r),e===t.promise?a(TypeError("Promise-chain cycle")):(i=T(e))?i.call(e,c,a):c(e)):a(r)}catch(s){a(s)}};e.length>i;)c(e[i++]);e.length=0,n.n=!1,t&&setTimeout(function(){var t,e,o=n.p;I(o)&&(x?w.emit("unhandledRejection",r,o):(t=u.onunhandledrejection)?t({promise:o,reason:r}):(e=u.console)&&e.error&&e.error("Unhandled promise rejection",r)),n.a=void 0},1)})}},I=function(n){var t,e=n._d,r=e.a||e.c,o=0;if(e.h)return!1;for(;r.length>o;)if(t=r[o++],t.fail||!I(t.promise))return!1;return!0},A=function(n){var t=this;t.d||(t.d=!0,t=t.r||t,t.v=n,t.s=2,t.a=t.c.slice(),C(t,!0))},F=function(n){var t,e=this;if(!e.d){e.d=!0,e=e.r||e;try{if(e.p===n)throw TypeError("Promise can't be resolved itself");(t=T(n))?b(function(){var r={r:e,d:!1};try{t.call(n,c(F,r,1),c(A,r,1))}catch(o){A.call(r,o)}}):(e.v=n,e.s=1,C(e,!1))}catch(r){A.call({r:e,d:!1},r)}}};S||(k=function(n){h(n);var t=this._d={p:d(this,k,_),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{n(c(F,t,1),c(A,t,1))}catch(e){A.call(t,e)}},e(45)(k.prototype,{then:function(n,t){var e=new j(g(this,k)),r=e.promise,o=this._d;return e.ok="function"==typeof n?n:!0,e.fail="function"==typeof t&&t,o.c.push(e),o.a&&o.a.push(e),o.s&&C(o,!1),r},"catch":function(n){return this.then(void 0,n)}})),s(s.G+s.W+s.F*!S,{Promise:k}),e(16)(k,_),e(48)(_),r=e(3)[_],s(s.S+s.F*!S,_,{reject:function(n){var t=new j(this),e=t.reject;return e(n),t.promise}}),s(s.S+s.F*(!S||P(!0)),_,{resolve:function(n){if(n instanceof k&&D(n.constructor,this))return n;var t=new j(this),e=t.resolve;return e(n),t.promise}}),s(s.S+s.F*!(S&&e(41)(function(n){k.all(n)["catch"](function(){})})),_,{all:function(n){var t=O(this),e=new j(t),r=e.resolve,i=e.reject,u=[],c=E(function(){p(n,!1,u.push,u);var e=u.length,c=Array(e);e?o.each.call(u,function(n,o){var u=!1;t.resolve(n).then(function(n){u||(u=!0,c[o]=n,--e||r(c))},i)}):r(c)});return c&&i(c.error),e.promise},race:function(n){var t=O(this),e=new j(t),r=e.reject,o=E(function(){p(n,!1,function(n){t.resolve(n).then(e.resolve,r)})});return o&&r(o.error),e.promise}})},function(n,t,e){"use strict";var r=e(52)(!0);e(22)(String,"String",function(n){this._t=String(n),this._i=0},function(){var n,t=this._t,e=this._i;return e>=t.length?{value:void 0,done:!0}:(n=r(t,e),this._i+=n.length,{value:n,done:!1})})},function(n,t,e){e(59);var r=e(7);r.NodeList=r.HTMLCollection=r.Array},function(n,t,e){var r;(function(o){(function(n,t,e){"use strict";function r(n,t){return"object"!=typeof t&&(t=t()),Object.keys(t).forEach(function(e){n[e]=t[e]}),n}function i(n){return{from:function(t){return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,{extend:function(e){r(n.prototype,"object"!=typeof e?e(t.prototype):e)}}}}}function u(n,t){return t(n)}function c(n,t){function o(){On.on("versionchange",function(n){On.close(),On.on("error").fire(new vn("Database version changed by other database connection."))})}function l(n){this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function p(n,t,e,r){if(0===n){Object.keys(yn).forEach(function(n){w(t,n,yn[n].primKey,yn[n].indexes)});var o=On._createTransaction(Dn,gn,yn);o.idbtrans=t,o.idbtrans.onerror=C(e,["populating database"]),o.on("error").subscribe(e),R.newPSD(function(){R.PSD.trans=o;try{On.on("populate").fire(o)}catch(n){r.onerror=t.onerror=function(n){n.preventDefault()};try{t.abort()}catch(i){}t.db.close(),e(n)}})}else{var i=[],c=mn.filter(function(t){return t._cfg.version===n})[0];if(!c)throw new vn("Dexie specification of currently installed DB version is missing");yn=On._dbSchema=c._cfg.dbschema;var a=!1,s=mn.filter(function(t){return t._cfg.version>n});s.forEach(function(n){var r=yn,o=n._cfg.dbschema;sn(r,t),sn(o,t),yn=On._dbSchema=o;var c=b(r,o);c.add.forEach(function(n){i.push(function(t,e){w(t,n[0],n[1].primKey,n[1].indexes),e()})}),c.change.forEach(function(n){if(n.recreate)throw new vn("Not yet support for changing primary key");i.push(function(t,e){var r=t.objectStore(n.name);n.add.forEach(function(n){L(r,n)}),n.change.forEach(function(n){r.deleteIndex(n.name),L(r,n)}),n.del.forEach(function(n){r.deleteIndex(n)}),e()})}),n._cfg.contentUpgrade&&i.push(function(t,r){a=!0;var i=On._createTransaction(Dn,[].slice.call(t.db.objectStoreNames,0),o);i.idbtrans=t;var c=0;i._promise=u(i._promise,function(n){return function(t,e,o){function i(n){return function(){n.apply(this,arguments),0===--c&&r()}}return++c,n.call(this,t,function(n,t,r){arguments[0]=i(n),arguments[1]=i(t),e.apply(this,arguments)},o)}}),t.onerror=C(e,["running upgrader function for version",n._cfg.version]),i.on("error").subscribe(e),n._cfg.contentUpgrade(i),0===c&&r()}),a&&cn()||i.push(function(n,t){j(o,n),t()})});var f=function(){try{i.length?i.shift()(t,f):S(yn,t)}catch(n){r.onerror=t.onerror=function(n){n.preventDefault()};try{t.abort()}catch(o){}t.db.close(),e(n)}};f()}}function b(n,t){var e={del:[],add:[],change:[]};for(var r in n)t[r]||e.del.push(r);for(var r in t){var o=n[r],i=t[r];if(o){var u={name:r,def:t[r],recreate:!1,del:[],add:[],change:[]};if(o.primKey.src!==i.primKey.src)u.recreate=!0,e.change.push(u);else{var c=o.indexes.reduce(function(n,t){return n[t.name]=t,n},{}),a=i.indexes.reduce(function(n,t){return n[t.name]=t,n},{});for(var s in c)a[s]||u.del.push(s);for(var s in a){var f=c[s],l=a[s];f?f.src!==l.src&&u.change.push(l):u.add.push(l)}(u.recreate||u.del.length>0||u.add.length>0||u.change.length>0)&&e.change.push(u)}}else e.add.push([r,i])}return e}function w(n,t,e,r){var o=n.db.createObjectStore(t,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach(function(n){L(o,n)}),o}function S(n,t){Object.keys(n).forEach(function(e){t.db.objectStoreNames.contains(e)||w(t,e,n[e].primKey,n[e].indexes)})}function j(n,t){for(var r=0;r<t.db.objectStoreNames.length;++r){var o=t.db.objectStoreNames[r];(null===n[o]||n[o]===e)&&t.db.deleteObjectStore(o)}}function L(n,t){n.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function G(n,t){throw new vn("Table "+t[0]+" not part of transaction. Original Scope Function Source: "+c.Promise.PSD.trans.scopeFunc.toString())}function J(n,t,e,r){this.name=n,this.schema=e,this.hook=bn[n]?bn[n].hook:g(null,{creating:[h,a],reading:[f,s],updating:[d,a],deleting:[y,a]}),this._tpf=t,this._collClass=r||Y}function z(n,t,e,r){J.call(this,n,t,e,r||Q)}function H(n,t,e,r){function o(n,t,e,r){return i._promise(n,e,r)}var i=this;this.db=On,this.mode=n,this.storeNames=t,this.idbtrans=null,this.on=g(this,["complete","error"],"abort"),this._reculock=0,this._blockedFuncs=[],this._psd=null,this.active=!0,this._dbschema=e,r&&(this.parent=r),this._tpf=o,this.tables=Object.create(_n);for(var u=t.length-1;-1!==u;--u){var c=t[u],a=On._tableFactory(n,e[c],o);this.tables[c]=a,this[c]||(this[c]=a)}}function V(n,t,e){this._ctx={table:n,index:":id"===t?null:t,collClass:n._collClass,or:e}}function Y(n,t){var e=null,r=null;if(t)try{e=t()}catch(o){r=o}var i=n._ctx;this._ctx={table:i.table,index:i.index,isPrimKey:!i.index||i.table.schema.primKey.keyPath&&i.index===i.table.schema.primKey.name,range:e,op:"openCursor",dir:"next",unique:"",algorithm:null,filter:null,isMatch:null,offset:0,limit:1/0,error:r,or:i.or}}function Q(){Y.apply(this,arguments)}function X(n,t){return n._cfg.version-t._cfg.version}function Z(n,t,e,r,o,i){e.forEach(function(e){var u=On._tableFactory(r,o[e],t);n.forEach(function(n){n[e]||(i?Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){var n=R.PSD&&R.PSD.trans;return n&&n.db===On?n.tables[e]:u}}):n[e]=u)})})}function $(n){n.forEach(function(n){for(var t in n)n[t]instanceof J&&delete n[t]})}function nn(n,t,e,r,o,i){var u=R.PSD;i=i||s,n.onerror||(n.onerror=C(o)),t?n.onsuccess=x(function(u){var c=n.result;if(c){var a=function(){c["continue"]()};t(c,function(n){a=n},r,o)&&e(i(c.value),c,function(n){a=n}),a()}else r()},o,u):n.onsuccess=x(function(t){var o=n.result;if(o){var u=function(){o["continue"]()};e(i(o.value),o,function(n){u=n}),u()}else r()},o,u)}function tn(n){var t=[];return n.split(",").forEach(function(n){n=n.trim();var e=n.replace("&","").replace("++","").replace("*",""),r=0!==e.indexOf("[")?e:n.substring(n.indexOf("[")+1,n.indexOf("]")).split("+");t.push(new K(e,r||null,-1!==n.indexOf("&"),-1!==n.indexOf("*"),-1!==n.indexOf("++"),Array.isArray(r),-1!==r.indexOf(".")))}),t}function en(n,t){return t>n?-1:n>t?1:0}function rn(n,t){return t>n?1:n>t?-1:0}function on(n){return function(t,e){for(var r=0;;){var o=n(t[r],e[r]);if(0!==o)return o;if(++r,r===t.length||r===e.length)return n(t.length,e.length)}}}function un(n,t){return n?t?function(){return n.apply(this,arguments)&&t.apply(this,arguments)}:n:t}function cn(){return navigator.userAgent.indexOf("Trident")>=0||navigator.userAgent.indexOf("MSIE")>=0}function an(){if(On.verno=wn.version/10,On._dbSchema=yn={},gn=[].slice.call(wn.objectStoreNames,0),0!==gn.length){var n=wn.transaction(N(gn),"readonly");gn.forEach(function(t){for(var e=n.objectStore(t),r=e.keyPath,o=r&&"string"==typeof r&&-1!==r.indexOf("."),i=new K(r,r||"",!1,!1,!!e.autoIncrement,r&&"string"!=typeof r,o),u=[],c=0;c<e.indexNames.length;++c){var a=e.index(e.indexNames[c]);r=a.keyPath,o=r&&"string"==typeof r&&-1!==r.indexOf(".");var s=new K(a.name,r,!!a.unique,!!a.multiEntry,!1,r&&"string"!=typeof r,o);u.push(s)}yn[t]=new B(t,i,u,{})}),Z([bn],On._transPromiseFactory,Object.keys(yn),Dn,yn)}}function sn(n,t){for(var e=t.db.objectStoreNames,r=0;r<e.length;++r)for(var o=e[r],i=t.objectStore(o),u=0;u<i.indexNames.length;++u){var c=i.indexNames[u],a=i.index(c).keyPath,s="string"==typeof a?a:"["+[].slice.call(a).join("+")+"]";if(n[o]){var f=n[o].idxByName[s];f&&(f.name=c)}}}var fn=t&&t.addons||c.addons,ln=c.dependencies,hn=ln.indexedDB,dn=ln.IDBKeyRange,pn=(ln.IDBTransaction,ln.DOMError,ln.TypeError),vn=ln.Error,yn=this._dbSchema={},mn=[],gn=[],bn={},_n={},wn=null,xn=!0,kn=null,Pn=!1,Sn="readonly",Dn="readwrite",On=this,Tn=[],jn=!0,En=!!q();this.version=function(n){if(wn)throw new vn("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var t=mn.filter(function(t){return t._cfg.version===n})[0];return t?t:(t=new l(n),mn.push(t),mn.sort(X),t)},r(l.prototype,{stores:function(n){this._cfg.storesSource=this._cfg.storesSource?r(this._cfg.storesSource,n):n;var t={};mn.forEach(function(n){r(t,n._cfg.storesSource)});var e=this._cfg.dbschema={};return this._parseStoresSpec(t,e),yn=On._dbSchema=e,$([bn,On,_n]),Z([_n],G,Object.keys(e),Dn,e),Z([bn,On,this._cfg.tables],On._transPromiseFactory,Object.keys(e),Dn,e,!0),gn=Object.keys(e),this},upgrade:function(n){var t=this;return U(function(){n(On._createTransaction(Dn,Object.keys(t._cfg.dbschema),t._cfg.dbschema))}),this._cfg.contentUpgrade=n,this},_parseStoresSpec:function(n,t){Object.keys(n).forEach(function(e){if(null!==n[e]){var r={},o=tn(n[e]),i=o.shift();if(i.multi)throw new vn("Primary key cannot be multi-valued");i.keyPath&&P(r,i.keyPath,i.auto?0:i.keyPath),o.forEach(function(n){if(n.auto)throw new vn("Only primary key can be marked as autoIncrement (++)");if(!n.keyPath)throw new vn("Index must have a name and cannot be an empty string");P(r,n.keyPath,n.compound?n.keyPath.map(function(){return""}):"")}),t[e]=new B(e,i,o,r)}})}}),this._allTables=bn,this._tableFactory=function(n,t,e){return n===Sn?new J(t.name,e,t,Y):new z(t.name,e,t)},this._createTransaction=function(n,t,e,r){return new H(n,t,e,r)},this._transPromiseFactory=function(n,t,e){if(!xn||R.PSD&&R.PSD.letThrough){var r=On._createTransaction(n,t,yn);return r._promise(n,function(n,t){r.error(function(n){On.on("error").fire(n)}),e(function(t){r.complete(function(){n(t)})},t,r)})}var o=new R(function(r,i){Tn.push({resume:function(){var u=On._transPromiseFactory(n,t,e);o.onuncatched=u.onuncatched,u.then(r,i)}})});return o},this._whenReady=function(n){return new R(W||!xn||R.PSD&&R.PSD.letThrough?n:function(t,e){Tn.push({resume:function(){n(t,e)}})})},this.verno=0,this.open=function(){return new R(function(t,e){function r(n){try{o.transaction.abort()}catch(t){}Pn=!1,kn=n,xn=!1,e(kn),Tn.forEach(function(n){n.resume()}),Tn=[]}if(W&&t(On),wn||Pn)throw new vn("Database already opened or being opened");var o,i=!1;try{if(kn=null,Pn=!0,mn.length>0&&(jn=!1),!hn)throw new vn("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using Safari, make sure to include indexedDB polyfill.");if(o=jn?hn.open(n):hn.open(n,Math.round(10*On.verno)),!o)throw new vn("IndexedDB API not available");o.onerror=C(r,["opening database",n]),o.onblocked=function(n){On.on("blocked").fire(n)},o.onupgradeneeded=x(function(t){if(jn&&!On._allowEmptyDB){o.onerror=function(n){n.preventDefault()},o.transaction.abort(),o.result.close();var e=hn.deleteDatabase(n);e.onsuccess=e.onerror=function(){r(new vn("Database '"+n+"' doesnt exist"))}}else{0===t.oldVersion&&(i=!0),o.transaction.onerror=C(r);var u=t.oldVersion>Math.pow(2,62)?0:t.oldVersion;p(u/10,o.transaction,r,o)}},r),o.onsuccess=x(function(e){Pn=!1,wn=o.result,jn?an():wn.objectStoreNames.length>0&&sn(yn,wn.transaction(N(wn.objectStoreNames),Sn)),wn.onversionchange=On.on("versionchange").fire,En||F(function(t){return-1===t.indexOf(n)?t.push(n):void 0}),R.newPSD(function(){function n(){xn=!1,Tn.forEach(function(n){n.resume()}),Tn=[],t(On)}R.PSD.letThrough=!0;try{var e=On.on.ready.fire();e&&"function"==typeof e.then?e.then(n,function(n){wn.close(),wn=null,r(n)}):_(n)}catch(o){r(o)}})},r)}catch(u){r(u)}})},this.close=function(){wn&&(wn.close(),wn=null,xn=!0,kn=null)},this["delete"]=function(){var t=arguments;return new R(function(e,r){function o(){On.close();var t=hn.deleteDatabase(n);t.onsuccess=function(){En||F(function(t){var e=t.indexOf(n);return e>=0?t.splice(e,1):void 0}),e()},t.onerror=C(r,["deleting",n]),t.onblocked=function(){On.on("blocked").fire()}}if(t.length>0)throw new vn("Arguments not allowed in db.delete()");Pn?Tn.push({resume:o}):o()})},this.backendDB=function(){return wn},this.isOpen=function(){return null!==wn},this.hasFailed=function(){return null!==kn},this.dynamicallyOpened=function(){return jn},this.name=n,Object.defineProperty(this,"tables",{get:function(){return Object.keys(bn).map(function(n){return bn[n]})}}),this.on=g(this,"error","populate","blocked",{ready:[m,a],versionchange:[v,a]}),this.on.ready.subscribe=u(this.on.ready.subscribe,function(n){return function(t,e){function r(){return e||On.on.ready.unsubscribe(r),t.apply(this,arguments)}n.call(this,r),On.isOpen()&&(xn?Tn.push({resume:r}):r())}}),U(function(){On.on("populate").fire(On._createTransaction(Dn,gn,yn)),On.on("error").fire(new vn)}),this.transaction=function(n,t,e){function r(t,r){var i=null;try{if(a)throw a;i=On._createTransaction(n,s,yn,o);var c=s.map(function(n){return i.tables[n]});c.push(i);var f,l=0;R.newPSD(function(){R.PSD.trans=i,i.scopeFunc=e,o&&(i.idbtrans=o.idbtrans,i._promise=u(i._promise,function(n){return function(t,e,r){function o(n){return function(t){var e;return R._rootExec(function(){e=n(t),R._tickFinalize(function(){0===--l&&i.active&&(i.active=!1,
i.on.complete.fire())})}),e}}return++l,n.call(this,t,function(n,t,r){return e(o(n),o(t),r)},r)}})),i.complete(function(){t(f)}),i.error(function(n){i.idbtrans&&(i.idbtrans.onerror=A);try{i.abort()}catch(t){}o&&(o.active=!1,o.on.error.fire(n));var e=r(n);o||e||On.on.error.fire(n)}),R._rootExec(function(){f=e.apply(i,c)})}),(!i.idbtrans||o&&0===l)&&i._nop()}catch(h){i&&i.idbtrans&&(i.idbtrans.onerror=A),i&&i.abort(),o&&o.on.error.fire(h),_(function(){r(h)||On.on("error").fire(h)})}}t=[].slice.call(arguments,1,arguments.length-1),e=arguments[arguments.length-1];var o=R.PSD&&R.PSD.trans;o&&o.db===On&&-1===n.indexOf("!")||(o=null);var i=-1!==n.indexOf("?");n=n.replace("!","").replace("?","");var c=Array.isArray(t[0])?t.reduce(function(n,t){return n.concat(t)}):t,a=null,s=c.map(function(n){return"string"==typeof n?n:(n instanceof J||(a=a||new pn("Invalid type. Arguments following mode must be instances of Table or String")),n.name)});return"r"==n||n==Sn?n=Sn:"rw"==n||n==Dn?n=Dn:a=new vn("Invalid transaction mode: "+n),o&&(a||(o&&o.mode===Sn&&n===Dn&&(i?o=null:a=a||new vn("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY")),o&&s.forEach(function(n){o.tables.hasOwnProperty(n)||(i?o=null:a=a||new vn("Table "+n+" not included in parent transaction. Parent Transaction function: "+o.scopeFunc.toString()))}))),o?o._promise(n,r,"lock"):On._whenReady(r)},this.table=function(n){if(W&&jn)return new z(n);if(!bn.hasOwnProperty(n))throw new vn("Table does not exist");return bn[n]},r(J.prototype,function(){function n(){throw new vn("Current Transaction is READONLY")}return{_trans:function(n,t,e){return this._tpf(n,[this.name],t,e)},_idbstore:function(n,t,e){if(W)return new R(t);var r=this;return this._tpf(n,[this.name],function(n,e,o){t(n,e,o.idbtrans.objectStore(r.name),o)},e)},get:function(n,t){var e=this;return this._idbstore(Sn,function(t,r,o){W&&t(e.schema.instanceTemplate);var i=o.get(n);i.onerror=C(r,["getting",n,"from",e.name]),i.onsuccess=function(){t(e.hook.reading.fire(i.result))}}).then(t)},where:function(n){return new V(this,n)},count:function(n){return this.toCollection().count(n)},offset:function(n){return this.toCollection().offset(n)},limit:function(n){return this.toCollection().limit(n)},reverse:function(){return this.toCollection().reverse()},filter:function(n){return this.toCollection().and(n)},each:function(n){var t=this;return W&&n(t.schema.instanceTemplate),this._idbstore(Sn,function(e,r,o){var i=o.openCursor();i.onerror=C(r,["calling","Table.each()","on",t.name]),nn(i,null,n,e,r,t.hook.reading.fire)})},toArray:function(n){var t=this;return this._idbstore(Sn,function(n,e,r){W&&n([t.schema.instanceTemplate]);var o=[],i=r.openCursor();i.onerror=C(e,["calling","Table.toArray()","on",t.name]),nn(i,null,function(n){o.push(n)},function(){n(o)},e,t.hook.reading.fire)}).then(n)},orderBy:function(n){return new this._collClass(new V(this,n))},toCollection:function(){return new this._collClass(new V(this))},mapToClass:function(n,t){this.schema.mappedClass=n;var e=Object.create(n.prototype);t&&E(e,t),this.schema.instanceTemplate=e;var r=function(t){if(!t)return t;var e=Object.create(n.prototype);for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),n},defineClass:function(n){return this.mapToClass(c.defineClass(n),n)},add:n,put:n,"delete":n,clear:n,update:n}}),i(z).from(J).extend(function(){return{add:function(n,t){var r=this,o=this.hook.creating.fire;return this._idbstore(Dn,function(i,u,c,s){var f={};if(o!==a){var l=t||(c.keyPath?k(n,c.keyPath):e),h=o.call(f,l,n,s);l===e&&h!==e&&(c.keyPath?P(n,c.keyPath,h):t=h)}var d=t?c.add(n,t):c.add(n);d.onerror=C(function(n){return f.onerror&&f.onerror(n),u(n)},["adding",n,"into",r.name]),d.onsuccess=function(t){var e=c.keyPath;e&&P(n,e,t.target.result),f.onsuccess&&f.onsuccess(t.target.result),i(d.result)}})},put:function(n,t){var r=this,o=this.hook.creating.fire,i=this.hook.updating.fire;return o!==a||i!==a?this._trans(Dn,function(o,i,u){var c=t||r.schema.primKey.keyPath&&k(n,r.schema.primKey.keyPath);c===e?u.tables[r.name].add(n).then(o,i):(u._lock(),n=O(n),u.tables[r.name].where(":id").equals(c).modify(function(t){this.value=n}).then(function(e){return 0===e?u.tables[r.name].add(n,t):c})["finally"](function(){u._unlock()}).then(o,i))}):this._idbstore(Dn,function(e,o,i){var u=t?i.put(n,t):i.put(n);u.onerror=C(o,["putting",n,"into",r.name]),u.onsuccess=function(t){var r=i.keyPath;r&&P(n,r,t.target.result),e(u.result)}})},"delete":function(n){return this.hook.deleting.subscribers.length?this.where(":id").equals(n)["delete"]():this._idbstore(Dn,function(t,e,r){var o=r["delete"](n);o.onerror=C(e,["deleting",n,"from",r.name]),o.onsuccess=function(n){t(o.result)}})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection()["delete"]():this._idbstore(Dn,function(n,t,e){var r=e.clear();r.onerror=C(t,["clearing",e.name]),r.onsuccess=function(t){n(r.result)}})},update:function(n,t){if("object"!=typeof t||Array.isArray(t))throw new vn("db.update(keyOrObject, modifications). modifications must be an object.");if("object"!=typeof n||Array.isArray(n))return this.where(":id").equals(n).modify(t);Object.keys(t).forEach(function(e){P(n,e,t[e])});var r=k(n,this.schema.primKey.keyPath);return r===e&&R.reject(new vn("Object does not contain its primary key")),this.where(":id").equals(r).modify(t)}}}),r(H.prototype,{_lock:function(){return++this._reculock,1===this._reculock&&R.PSD&&(R.PSD.lockOwnerFor=this),this},_unlock:function(){if(0===--this._reculock)for(R.PSD&&(R.PSD.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var n=this._blockedFuncs.shift();try{n()}catch(t){}}return this},_locked:function(){return this._reculock&&(!R.PSD||R.PSD.lockOwnerFor!==this)},_nop:function(n){this.tables[this.storeNames[0]].get(0).then(n)},_promise:function(n,t,e){var r=this;return R.newPSD(function(){var o;return r._locked()?o=new R(function(o,i){r._blockedFuncs.push(function(){r._promise(n,t,e).then(o,i)})}):(o=r.active?new R(function(o,i){if(!r.idbtrans&&n){if(!wn)throw new vn(kn?"Database not open. Following error in populate, ready or upgrade function made Dexie.open() fail: "+kn:"Database not open");var u=r.idbtrans=wn.transaction(N(r.storeNames),r.mode);u.onerror=function(n){r.on("error").fire(n&&n.target.error),n.preventDefault(),r.abort()},u.onabort=function(n){_(function(){r.on("error").fire(new vn("Transaction aborted for unknown reason"))}),r.active=!1,r.on("abort").fire(n)},u.oncomplete=function(n){r.active=!1,r.on("complete").fire(n)}}e&&r._lock();try{t(o,i,r)}catch(a){c.ignoreTransaction(function(){r.on("error").fire(a)}),r.abort(),i(a)}}):R.reject(I(new vn("Transaction is inactive. Original Scope Function Source: "+r.scopeFunc.toString()))),r.active&&e&&o["finally"](function(){r._unlock()})),o.onuncatched=function(n){c.ignoreTransaction(function(){r.on("error").fire(n)}),r.abort()},o})},complete:function(n){return this.on("complete",n)},error:function(n){return this.on("error",n)},abort:function(){if(this.idbtrans&&this.active)try{this.active=!1,this.idbtrans.abort(),this.on.error.fire(new vn("Transaction Aborted"))}catch(n){}},table:function(n){if(!this.tables.hasOwnProperty(n))throw new vn("Table "+n+" not in transaction");return this.tables[n]}}),r(V.prototype,function(){function n(n,t){try{throw t}catch(e){n._ctx.error=e}return n}function t(n){return Array.prototype.slice.call(1===n.length&&Array.isArray(n[0])?n[0]:n)}function e(n){return"next"===n?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()}}function r(n){return"next"===n?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()}}function o(n,t,e,r,o,i){for(var u=Math.min(n.length,r.length),c=-1,a=0;u>a;++a){var s=t[a];if(s!==r[a])return o(n[a],e[a])<0?n.substr(0,a)+e[a]+e.substr(a+1):o(n[a],r[a])<0?n.substr(0,a)+r[a]+e.substr(a+1):c>=0?n.substr(0,c)+t[c]+e.substr(c+1):null;o(n[a],s)<0&&(c=a)}return u<r.length&&"next"===i?n+e.substr(n.length):u<n.length&&"prev"===i?n.substr(0,e.length):0>c?null:n.substr(0,c)+r[c]+e.substr(c+1)}function i(n,t,i){function u(n){c=e(n),a=r(n),s="next"===n?en:rn,f=c(i),l=a(i),h=n}var c,a,s,f,l,h;u("next"),n._ondirectionchange=function(n){u(n)},n._addAlgorithm(function(n,e,r){var i=n.key;if("string"!=typeof i)return!1;var u=a(i);if(t(u,l))return e(function(){n["continue"]()}),!0;var c=o(i,u,f,l,s,h);return e(c?function(){n["continue"](c)}:r),!1})}return{between:function(n,t,e,r){return e=e!==!1,r=r===!0,n>t||n===t&&(e||r)&&(!e||!r)?new this._ctx.collClass(this,function(){return dn.only(n)}).limit(0):new this._ctx.collClass(this,function(){return dn.bound(n,t,!e,!r)})},equals:function(n){return new this._ctx.collClass(this,function(){return dn.only(n)})},above:function(n){return new this._ctx.collClass(this,function(){return dn.lowerBound(n,!0)})},aboveOrEqual:function(n){return new this._ctx.collClass(this,function(){return dn.lowerBound(n)})},below:function(n){return new this._ctx.collClass(this,function(){return dn.upperBound(n,!0)})},belowOrEqual:function(n){return new this._ctx.collClass(this,function(){return dn.upperBound(n)})},startsWith:function(t){return"string"!=typeof t?n(new this._ctx.collClass(this),new pn("String expected")):this.between(t,t+String.fromCharCode(65535),!0,!0)},startsWithIgnoreCase:function(t){if("string"!=typeof t)return n(new this._ctx.collClass(this),new pn("String expected"));if(""===t)return this.startsWith(t);var e=new this._ctx.collClass(this,function(){return dn.bound(t.toUpperCase(),t.toLowerCase()+String.fromCharCode(65535))});return i(e,function(n,t){return 0===n.indexOf(t)},t),e._ondirectionchange=function(){n(e,new vn("reverse() not supported with WhereClause.startsWithIgnoreCase()"))},e},equalsIgnoreCase:function(t){if("string"!=typeof t)return n(new this._ctx.collClass(this),new pn("String expected"));var e=new this._ctx.collClass(this,function(){return dn.bound(t.toUpperCase(),t.toLowerCase())});return i(e,function(n,t){return n===t},t),e},anyOf:function(n){var e=this._ctx,r=e.table.schema,o=e.index?r.idxByName[e.index]:r.primKey,i=o&&o.compound,u=t(arguments),c=i?on(en):en;if(u.sort(c),0===u.length)return new this._ctx.collClass(this,function(){return dn.only("")}).limit(0);var a=new this._ctx.collClass(this,function(){return dn.bound(u[0],u[u.length-1])});a._ondirectionchange=function(n){c="next"===n?en:rn,i&&(c=on(c)),u.sort(c)};var s=0;return a._addAlgorithm(function(n,t,e){for(var r=n.key;c(r,u[s])>0;)if(++s,s===u.length)return t(e),!1;return 0===c(r,u[s])?(t(function(){n["continue"]()}),!0):(t(function(){n["continue"](u[s])}),!1)}),a},notEqual:function(n){return this.below(n).or(this._ctx.index).above(n)},noneOf:function(n){var e=this._ctx,r=e.table.schema,o=e.index?r.idxByName[e.index]:r.primKey,i=o&&o.compound,u=t(arguments);if(0===u.length)return new this._ctx.collClass(this);var c=i?on(en):en;u.sort(c);var a=u.reduce(function(n,t){return n?n.concat([[n[n.length-1][1],t]]):[[null,t]]},null);a.push([u[u.length-1],null]);var s=this,f=e.index;return a.reduce(function(n,t){return n?null===t[1]?n.or(f).above(t[0]):n.or(f).between(t[0],t[1],!1,!1):s.below(t[1])},null)},startsWithAnyOf:function(e){function r(n){return n>c[s]}function o(n){return n<u[s]}var i=this._ctx,u=t(arguments);if(!u.every(function(n){return"string"==typeof n}))return n(new i.collClass(this),new pn("startsWithAnyOf() only works with strings"));if(0===u.length)return new i.collClass(this,function(){return dn.only("")}).limit(0);var c=u.map(function(n){return n+String.fromCharCode(65535)}),a=en;u.sort(a);var s=0,f=r,l=new i.collClass(this,function(){return dn.bound(u[0],u[u.length-1]+String.fromCharCode(65535))});return l._ondirectionchange=function(n){"next"===n?(f=r,a=en):(f=o,a=rn),u.sort(a),c.sort(a)},l._addAlgorithm(function(n,t,e){for(var r=n.key;f(r);)if(++s,s===u.length)return t(e),!1;return r>=u[s]&&r<=c[s]?(t(function(){n["continue"]()}),!0):(t(function(){a===en?n["continue"](u[s]):n["continue"](c[s])}),!1)}),l}}}),r(Y.prototype,function(){function n(n,t){n.filter=un(n.filter,t)}function t(n,t){n.isMatch=un(n.isMatch,t)}function e(n,t){if(n.isPrimKey)return t;var e=n.table.schema.idxByName[n.index];if(!e)throw new vn("KeyPath "+n.index+" on object store "+t.name+" is not indexed");return n.isPrimKey?t:t.index(e.name)}function r(n,t){return e(n,t)[n.op](n.range||null,n.dir+n.unique)}function o(n,t,e,o,i){n.or?!function(){function u(){2===++f&&e()}function c(n,e,r){if(!a||a(e,r,u,o)){var i=e.primaryKey.toString();s.hasOwnProperty(i)||(s[i]=!0,t(n,e,r))}}var a=n.filter,s={},f=(n.table.schema.primKey.keyPath,0);n.or._iterate(c,u,o,i),nn(r(n,i),n.algorithm,c,u,o,n.table.hook.reading.fire)}():nn(r(n,i),un(n.algorithm,n.filter),t,e,o,n.table.hook.reading.fire)}function i(n){return n.table.schema.instanceTemplate}return{_read:function(n,t){var e=this._ctx;return e.error?e.table._trans(null,function(n,t){t(e.error)}):e.table._idbstore(Sn,n).then(t)},_write:function(n){var t=this._ctx;return t.error?t.table._trans(null,function(n,e){e(t.error)}):t.table._idbstore(Dn,n,"locked")},_addAlgorithm:function(n){var t=this._ctx;t.algorithm=un(t.algorithm,n)},_iterate:function(n,t,e,r){return o(this._ctx,n,t,e,r)},each:function(n){var t=this._ctx;return W&&n(i(t)),this._read(function(e,r,i){o(t,n,e,r,i)})},count:function(n){if(W)return R.resolve(0).then(n);var t=this,r=this._ctx;if(r.filter||r.algorithm||r.or){var i=0;return this._read(function(n,t,e){o(r,function(){return++i,!1},function(){n(i)},t,e)},n)}return this._read(function(n,o,i){var u=e(r,i),c=r.range?u.count(r.range):u.count();c.onerror=C(o,["calling","count()","on",t.name]),c.onsuccess=function(t){n(Math.min(t.target.result,Math.max(0,r.limit-r.offset)))}},n)},sortBy:function(n,t){function e(n,t){return t?e(n[o[t]],t-1):n[i]}function r(n,t){var r=e(n,u),o=e(t,u);return o>r?-c:r>o?c:0}var o=(this._ctx,n.split(".").reverse()),i=o[0],u=o.length-1,c="next"===this._ctx.dir?1:-1;return this.toArray(function(n){return n.sort(r)}).then(t)},toArray:function(n){var t=this._ctx;return this._read(function(n,e,r){W&&n([i(t)]);var u=[];o(t,function(n){u.push(n)},function(){n(u)},e,r)},n)},offset:function(t){var e=this._ctx;return 0>=t?this:(e.offset+=t,e.or||e.algorithm||e.filter?n(e,function(n,e,r){return--t<0}):n(e,function(n,e,r){return 0===t?!0:1===t?(--t,!1):(e(function(){n.advance(t),t=0}),!1)}),this)},limit:function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),n(this._ctx,function(n,e,r){return--t<=0&&e(r),t>=0}),this},until:function(t,e){var r=this._ctx;return W&&t(i(r)),n(this._ctx,function(n,r,o){return t(n.value)?(r(o),e):!0}),this},first:function(n){return this.limit(1).toArray(function(n){return n[0]}).then(n)},last:function(n){return this.reverse().first(n)},and:function(e){return W&&e(i(this._ctx)),n(this._ctx,function(n){return e(n.value)}),t(this._ctx,e),this},or:function(n){return new V(this._ctx.table,n,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(n){var t=this._ctx;return W&&n(k(i(this._ctx),this._ctx.index?this._ctx.table.schema.idxByName[this._ctx.index].keyPath:this._ctx.table.schema.primKey.keyPath)),t.isPrimKey||(t.op="openKeyCursor"),this.each(function(t,e){n(e.key,e)})},eachUniqueKey:function(n){return this._ctx.unique="unique",this.eachKey(n)},keys:function(n){var t=this._ctx;t.isPrimKey||(t.op="openKeyCursor");var e=[];return W?new R(this.eachKey.bind(this)).then(function(n){return[n]}).then(n):this.each(function(n,t){e.push(t.key)}).then(function(){return e}).then(n)},uniqueKeys:function(n){return this._ctx.unique="unique",this.keys(n)},firstKey:function(n){return this.limit(1).keys(function(n){return n[0]}).then(n)},lastKey:function(n){return this.reverse().firstKey(n)},distinct:function(){var t={};return n(this._ctx,function(n){var e=n.primaryKey.toString(),r=t.hasOwnProperty(e);return t[e]=!0,!r}),this}}}),i(Q).from(Y).extend({modify:function(n){var t=this,e=this._ctx,o=e.table.hook,i=o.updating.fire,u=o.deleting.fire;return W&&"function"==typeof n&&n.call({value:e.table.schema.instanceTemplate},e.table.schema.instanceTemplate),this._write(function(o,c,s,f){function l(n,t,r){S=t.primaryKey;var o={primKey:t.primaryKey,value:n};if(p.call(o,n)!==!1){var i=!o.hasOwnProperty("value"),u=i?t["delete"]():t.update(o.value);++g,u.onerror=C(function(n){return w.push(n),x.push(o.primKey),o.onerror&&o.onerror(n),d(),!0},i?["deleting",n,"from",e.table.name]:["modifying",n,"on",e.table.name]),u.onsuccess=function(n){o.onsuccess&&o.onsuccess(o.value),++b,d()}}else o.onsuccess&&o.onsuccess(o.value)}function h(n){return n&&(w.push(n),x.push(S)),c(new M("Error modifying one or more objects",w,b,x))}function d(){_&&b+w.length===g&&(w.length>0?h():o(b))}var p;if("function"==typeof n)p=i===a&&u===a?n:function(t){var e=O(t);if(n.call(this,t)===!1)return!1;if(this.hasOwnProperty("value")){var r=T(e,this.value),o=i.call(this,r,this.primKey,e,f);o&&(t=this.value,Object.keys(o).forEach(function(n){P(t,n,o[n])}))}else u.call(this,this.primKey,t,f)};else if(i===a){var v=Object.keys(n),y=v.length;p=function(t){for(var e=!1,r=0;y>r;++r){var o=v[r],i=n[o];k(t,o)!==i&&(P(t,o,i),e=!0)}return e}}else{var m=n;n=D(m),p=function(t){var e=!1,o=i.call(this,n,this.primKey,O(t),f);return o&&r(n,o),Object.keys(n).forEach(function(r){var o=n[r];k(t,r)!==o&&(P(t,r,o),e=!0)}),o&&(n=D(m)),e}}var g=0,b=0,_=!1,w=[],x=[],S=null;t._iterate(l,function(){_=!0,d()},h,s)})},"delete":function(){return this.modify(function(){delete this.value})}}),r(this,{Collection:Y,Table:J,Transaction:H,Version:l,WhereClause:V,WriteableCollection:Q,WriteableTable:z}),o(),fn.forEach(function(n){n(On)})}function a(){}function s(n){return n}function f(n,t){return n===s?t:function(e){return t(n(e))}}function l(n,t){return function(){n.apply(this,arguments),t.apply(this,arguments)}}function h(n,t){return n===a?t:function(){var r=n.apply(this,arguments);r!==e&&(arguments[0]=r);var o=this.onsuccess,i=this.onerror;delete this.onsuccess,delete this.onerror;var u=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?l(o,this.onsuccess):o),i&&(this.onerror=this.onerror?l(i,this.onerror):i),u!==e?u:r}}function d(n,t){return n===a?t:function(){var o=n.apply(this,arguments);o!==e&&r(arguments[0],o);var i=this.onsuccess,u=this.onerror;delete this.onsuccess,delete this.onerror;var c=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?l(i,this.onsuccess):i),u&&(this.onerror=this.onerror?l(u,this.onerror):u),o===e?c===e?e:c:c===e?o:r(o,c)}}function p(n,t){return n===a?t:function(){return n.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function v(n,t){return n===a?t:function(){return t.apply(this,arguments)===!1?!1:n.apply(this,arguments)}}function y(n,t){return n===a?t:function(){n.apply(this,arguments),t.apply(this,arguments)}}function m(n,t){return n===a?t:function(){var e=n.apply(this,arguments);if(e&&"function"==typeof e.then){var r=this,o=arguments;return e.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}function g(t,e){function r(n,t,e){if(Array.isArray(n))return i(n);if("object"==typeof n)return o(n);t||(t=p),e||(e=a);var r={subscribers:[],fire:e,subscribe:function(n){r.subscribers.push(n),r.fire=t(r.fire,n)},unsubscribe:function(n){r.subscribers=r.subscribers.filter(function(t){return t!==n}),r.fire=r.subscribers.reduce(t,e)}};return c[n]=s[n]=r,r}function o(t){Object.keys(t).forEach(function(e){var o=t[e];if(Array.isArray(o))r(e,t[e][0],t[e][1]);else{if("asap"!==o)throw new Error("Invalid event config");var i=r(e,null,function(){var t=arguments;i.subscribers.forEach(function(e){_(function(){e.apply(n,t)})})});i.subscribe=function(n){-1===i.subscribers.indexOf(n)&&i.subscribers.push(n)},i.unsubscribe=function(n){var t=i.subscribers.indexOf(n);-1!==t&&i.subscribers.splice(t,1)}}})}function i(n){function t(){return e?!1:void(e=!0)}var e=!1;n.forEach(function(n){r(n).subscribe(t)})}var u=arguments,c={},s=function(n,e){if(e){var r=[].slice.call(arguments,1),o=c[n];return o.subscribe.apply(o,r),t}return"string"==typeof n?c[n]:void 0};s.addEventType=r;for(var f=1,l=u.length;l>f;++f)r(u[f]);return s}function b(n){if(!n)throw new Error("Assertion failed")}function _(t){n.setImmediate?o(t):setTimeout(t,0)}function w(n){var t=setTimeout(n,1e3);clearTimeout(t)}function x(n,t,e){return function(){var r=R.PSD;R.PSD=e;try{n.apply(this,arguments)}catch(o){t(o)}finally{R.PSD=r}}}function k(n,t){if(n.hasOwnProperty(t))return n[t];if(!t)return n;if("string"!=typeof t){for(var r=[],o=0,i=t.length;i>o;++o){var u=k(n,t[o]);r.push(u)}return r}var c=t.indexOf(".");if(-1!==c){var a=n[t.substr(0,c)];return a===e?e:k(a,t.substr(c+1))}return e}function P(n,t,r){if(n&&t!==e)if("string"!=typeof t&&"length"in t){b("string"!=typeof r&&"length"in r);for(var o=0,i=t.length;i>o;++o)P(n,t[o],r[o])}else{var u=t.indexOf(".");if(-1!==u){var c=t.substr(0,u),a=t.substr(u+1);if(""===a)r===e?delete n[c]:n[c]=r;else{var s=n[c];s||(s=n[c]={}),P(s,a,r)}}else r===e?delete n[t]:n[t]=r}}function S(n,t){"string"==typeof t?P(n,t,e):"length"in t&&[].map.call(t,function(t){P(n,t,e)})}function D(n){var t={};for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e]);return t}function O(n){if(!n||"object"!=typeof n)return n;var t;if(Array.isArray(n)){t=[];for(var e=0,r=n.length;r>e;++e)t.push(O(n[e]))}else if(n instanceof Date)t=new Date,t.setTime(n.getTime());else{t=n.constructor?Object.create(n.constructor.prototype):{};for(var o in n)n.hasOwnProperty(o)&&(t[o]=O(n[o]))}return t}function T(n,t){var r={};for(var o in n)n.hasOwnProperty(o)&&(t.hasOwnProperty(o)?n[o]!==t[o]&&JSON.stringify(n[o])!=JSON.stringify(t[o])&&(r[o]=t[o]):r[o]=e);for(var o in t)t.hasOwnProperty(o)&&!n.hasOwnProperty(o)&&(r[o]=t[o]);return r}function j(n){if("function"==typeof n)return new n;if(Array.isArray(n))return[j(n[0])];if(n&&"object"==typeof n){var t={};return E(t,n),t}return n}function E(n,t){Object.keys(t).forEach(function(e){var r=j(t[e]);n[e]=r})}function C(n,t){return function(e){var r=e&&e.target.error||new Error;if(t){var o=" occurred when "+t.map(function(n){switch(typeof n){case"function":return n();case"string":return n;default:return JSON.stringify(n)}}).join(" ");r.name?r.toString=function(){return r.name+o+(r.message?". "+r.message:"")}:r+=o}return n(r),e&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()),!1}}function I(n){try{throw n}catch(t){return t}}function A(n){n.preventDefault()}function F(n){var t,e=c.dependencies.localStorage;if(!e)return n([]);try{t=JSON.parse(e.getItem("Dexie.DatabaseNames")||"[]")}catch(r){t=[]}n(t)&&e.setItem("Dexie.DatabaseNames",JSON.stringify(t))}function K(n,t,e,r,o,i,u){this.name=n,this.keyPath=t,this.unique=e,this.multi=r,this.auto=o,this.compound=i,this.dotted=u;var c="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(e?"&":"")+(r?"*":"")+(o?"++":"")+c}function B(n,t,e,r){this.name=n,this.primKey=t||new K,this.indexes=e||[new K],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=e.reduce(function(n,t){return n[t.name]=t,n},{})}function M(n,t,e,r){this.name="ModifyError",this.failures=t,this.failedKeys=r,this.successCount=e,this.message=t.join("\n")}function N(n){return 1===n.length?n[0]:n}function q(){var n=c.dependencies.indexedDB,t=n&&(n.getDatabaseNames||n.webkitGetDatabaseNames);return t&&t.bind(n)}var R=function(){function t(n,t){b.push([n,p.call(arguments,1)])}function e(){var t=b;b=[];for(var e=0,r=t.length;r>e;++e){var o=t[e];o[0].apply(n,o[1])}}function r(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],this._catched=!1;var t=this,e=!0;this._PSD=r.PSD;try{d(this,n,function(n){e?y(s,t,n):s(t,n)},function(n){return e?(y(f,t,n),!1):f(t,n)})}finally{e=!1}}function i(n,o){if(null===n._state)return void n._deferreds.push(o);var i=n._state?o.onFulfilled:o.onRejected;if(null===i)return(n._state?o.resolve:o.reject)(n._value);var u,a=m;m=!1,y=t;try{var s=r.PSD;r.PSD=n._PSD,u=i(n._value),n._state||u&&"function"==typeof u.then&&u._state===!1||c(n),o.resolve(u)}catch(f){var l=o.reject(f);if(!l&&n.onuncatched)try{n.onuncatched(f)}catch(f){}}finally{if(r.PSD=s,a){do{for(;b.length>0;)e();var h=_.pop();if(h)try{h()}catch(f){}}while(_.length>0||b.length>0);y=v,m=!0}}}function u(n){var r=m;m=!1,y=t;try{n()}finally{if(r){do{for(;b.length>0;)e();var o=_.pop();if(o)try{o()}catch(i){}}while(_.length>0||b.length>0);y=v,m=!0}}}function c(n){n._catched=!0,n._parent&&c(n._parent)}function s(n,t){var e=r.PSD;r.PSD=n._PSD;try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then)return void d(n,function(n,e){t.then(n,e)},function(t){s(n,t)},function(t){f(n,t)});n._state=!0,n._value=t,l.call(n)}catch(o){f(o)}finally{r.PSD=e}}function f(n,t){var e=r.PSD;if(r.PSD=n._PSD,n._state=!1,n._value=t,l.call(n),!n._catched)try{n.onuncatched&&n.onuncatched(n._value),r.on.error.fire(n._value)}catch(o){}return r.PSD=e,n._catched}function l(){for(var n=0,t=this._deferreds.length;t>n;n++)i(this,this._deferreds[n]);this._deferreds=[]}function h(n,t,e,r){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=r}function d(n,t,e,r){var o=!1;try{t(function(n){o||(o=!0,e(n))},function(t){return o?n._catched:(o=!0,r(t))})}catch(i){if(o)return;return r(i)}}var p=[].slice,v="undefined"==typeof o?function(t,e,r,o){var i=arguments;setTimeout(function(){t.apply(n,p.call(i,1))},0)}:o;w(function(){v=y=t=function(t){var e=arguments;setTimeout(function(){t.apply(n,p.call(e,1))},0)}});var y=v,m=!0,b=[],_=[];return r.on=g(null,"error"),r.all=function(){var n=Array.prototype.slice.call(1===arguments.length&&Array.isArray(arguments[0])?arguments[0]:arguments);return new r(function(t,e){function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,function(n){r(i,n)},e)}n[i]=u,0===--o&&t(n)}catch(a){e(a)}}if(0===n.length)return t([]);for(var o=n.length,i=0;i<n.length;i++)r(i,n[i])})},r.prototype.then=function(n,t){var e=this,o=new r(function(r,o){null===e._state?i(e,new h(n,t,r,o)):y(i,e,new h(n,t,r,o))});return o._PSD=this._PSD,o.onuncatched=this.onuncatched,o._parent=this,o},r.prototype._then=function(n,t){i(this,new h(n,t,a,a))},r.prototype["catch"]=function(n){if(1===arguments.length)return this.then(null,n);var t=arguments[0],e=arguments[1];return"function"==typeof t?this.then(null,function(n){return n instanceof t?e(n):r.reject(n)}):this.then(null,function(n){return n&&n.name===t?e(n):r.reject(n)})},r.prototype["finally"]=function(n){return this.then(function(t){return n(),t},function(t){return n(),r.reject(t)})},r.prototype.onuncatched=null,r.resolve=function(n){var t=new r(function(){});return t._state=!0,t._value=n,t},r.reject=function(n){var t=new r(function(){});return t._state=!1,t._value=n,t},r.race=function(n){return new r(function(t,e){n.map(function(n){n.then(t,e)})})},r.PSD=null,r.newPSD=function(n){var t=r.PSD;r.PSD=t?Object.create(t):{};try{return n()}finally{r.PSD=t}},r._rootExec=u,r._tickFinalize=function(n){if(m)throw new Error("Not in a virtual tick");_.push(n)},r}(),U=function(){},W=!1;i(M).from(Error),c["delete"]=function(n){var t=new c(n),e=t["delete"]();return e.onblocked=function(n){return t.on("blocked",n),this},e},c.exists=function(n){return new c(n).open().then(function(n){return n.close(),!0},function(){return!1})},c.getDatabaseNames=function(n){return new R(function(n,t){var e=q();if(e){var r=e();r.onsuccess=function(t){n([].slice.call(t.target.result,0))},r.onerror=C(t)}else F(function(t){return n(t),!1})}).then(n)},c.defineClass=function(n){function t(t){t?r(this,t):W&&E(this,n)}return t},c.ignoreTransaction=function(n){return R.newPSD(function(){return R.PSD.trans=null,n()})},c.spawn=function(){return n.console&&console.warn("Dexie.spawn() is deprecated. Use Dexie.ignoreTransaction() instead."),c.ignoreTransaction.apply(this,arguments)},c.vip=function(n){return R.newPSD(function(){return R.PSD.letThrough=!0,n()})},Object.defineProperty(c,"currentTransaction",{get:function(){return R.PSD&&R.PSD.trans||null}}),c.Promise=R,c.derive=i,c.extend=r,c.override=u,c.events=g,c.getByKeyPath=k,c.setByKeyPath=P,c.delByKeyPath=S,c.shallowClone=D,c.deepClone=O,c.addons=[],c.fakeAutoComplete=U,c.asap=_,c.ModifyError=M,c.MultiModifyError=M,c.IndexSpec=K,c.TableSchema=B;var L=n.idbModules&&n.idbModules.shimIndexedDB?n.idbModules:{};c.dependencies={indexedDB:L.shimIndexedDB||n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB,IDBKeyRange:L.IDBKeyRange||n.IDBKeyRange||n.webkitIDBKeyRange,IDBTransaction:L.IDBTransaction||n.IDBTransaction||n.webkitIDBTransaction,Error:n.Error||String,SyntaxError:n.SyntaxError||String,TypeError:n.TypeError||String,DOMError:n.DOMError||String,localStorage:null!=("undefined"!=typeof chrome&&null!==chrome?chrome.storage:void 0)?null:n.localStorage},c.version=1.2,t("Dexie",c),w(function(){c.fakeAutoComplete=U=w,c.fake=W=!0})}).apply(null,[self||window,function(o,i){r=function(){return i}.call(t,e,t,n),!(void 0!==r&&(n.exports=r))}])}).call(t,e(17).setImmediate)},function(n,t){function e(){s=!1,u.length?a=u.concat(a):f=-1,a.length&&r()}function r(){if(!s){var n=setTimeout(e);s=!0;for(var t=a.length;t;){for(u=a,a=[];++f<t;)u&&u[f].run();f=-1,t=a.length}u=null,s=!1,clearTimeout(n)}}function o(n,t){this.fun=n,this.array=t}function i(){}var u,c=n.exports={},a=[],s=!1,f=-1;c.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];a.push(new o(n,t)),1!==a.length||s||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=i,c.addListener=i,c.once=i,c.off=i,c.removeListener=i,c.removeAllListeners=i,c.emit=i,c.binding=function(n){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(n){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}}]);