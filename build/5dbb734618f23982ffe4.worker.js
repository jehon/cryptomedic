!function(t){function n(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";function r(t,n){postMessage({name:t,data:n})}function o(t){var n=a.resolve();return t.reset&&(n=n.then(function(){return console.info("Worker: resetting the database patients"),p.clear().then(function(){p.updateCheckpoint("")})})),t.data?n=n.then(function(){return p.bulkUpdate(t.data,function(t){r("folder",t)}).then(function(){t.isfinal?r("progress",{isfinal:!0}):r("progress",{isfinal:!1,remaining:parseInt(t.remaining),done:parseInt(t.data.length)})},function(t){throw console.error("Error in bulk insert",t),t})}):r("progress",{isfinal:!0}),n}function i(){return y&&clearTimeout(y),m=!1,y=setTimeout(c,36e5),a.resolve()}function u(){return y&&(clearTimeout(y),y=!1),m=!0,a.resolve()}function c(){u().then(function(){return p.getSetting("checkpoint")}).then(function(t){return(0,d["default"])(v+"/sync",{},{cp:t})}).then(function(t){return null==t?(console.warn("null result: unauthenticated?"),null):o(t._offline)})["catch"](function(t){r("error",t)}).then(i,i)}var a=e(10)["default"],s=e(11)["default"],f=e(27),l=s(f),h=e(28),d=s(h),p=(0,l["default"])(),v=!1,y=null,m=!1;onmessage=function(t){var n=t.data.name,e=t.data.data;switch(n){case"init":return e.restUrl&&(v=e.restUrl),c();case"sync":return c();case"resync":return p.updateCheckpoint(!1),c();default:return console.error("unkown message: "+n,e)}}},function(t,n,e){var r=e(50)("wks"),o=e(58),i=e(2).Symbol;t.exports=function(t){return r[t]||(r[t]=i&&i[t]||(i||o)("Symbol."+t))}},function(t,n){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},function(t,n){var e=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=e)},function(t,n){var e=Object;t.exports={create:e.create,getProto:e.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:e.getOwnPropertyDescriptor,setDesc:e.defineProperty,setDescs:e.defineProperties,getKeys:e.keys,getNames:e.getOwnPropertyNames,getSymbols:e.getOwnPropertySymbols,each:[].forEach}},function(t,n,e){var r=e(9);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,n,e){var r=e(12);t.exports=function(t,n,e){if(r(t),void 0===n)return t;switch(e){case 1:return function(e){return t.call(n,e)};case 2:return function(e,r){return t.call(n,e,r)};case 3:return function(e,r,o){return t.call(n,e,r,o)}}return function(){return t.apply(n,arguments)}}},function(t,n){t.exports={}},function(t,n){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},function(t,n){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,n,e){t.exports={"default":e(32),__esModule:!0}},function(t,n){"use strict";n["default"]=function(t){return t&&t.__esModule?t:{"default":t}},n.__esModule=!0},function(t,n){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,n){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,n,e){t.exports=!e(20)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,n,e){var r=e(2),o=e(3),i=e(6),u="prototype",c=function(t,n,e){var a,s,f,l=t&c.F,h=t&c.G,d=t&c.S,p=t&c.P,v=t&c.B,y=t&c.W,m=h?o:o[n]||(o[n]={}),g=h?r:d?r[n]:(r[n]||{})[u];h&&(e=n);for(a in e)s=!l&&g&&a in g,s&&a in m||(f=s?g[a]:e[a],m[a]=h&&"function"!=typeof g[a]?e[a]:v&&s?i(f,r):y&&g[a]==f?function(t){var n=function(n){return this instanceof t?new t(n):t(n)};return n[u]=t[u],n}(f):p&&"function"==typeof f?i(Function.call,f):f,p&&((m[u]||(m[u]={}))[a]=f))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,t.exports=c},function(t,n,e){var r=e(4),o=e(24);t.exports=e(14)?function(t,n,e){return r.setDesc(t,n,o(1,e))}:function(t,n,e){return t[n]=e,t}},function(t,n,e){var r=e(4).setDesc,o=e(21),i=e(1)("toStringTag");t.exports=function(t,n,e){t&&!o(t=e?t:t.prototype,i)&&r(t,i,{configurable:!0,value:n})}},function(t,n,e){(function(t,r){function o(t,n){this._id=t,this._clearFn=n}var i=e(67).nextTick,u=Function.prototype.apply,c=Array.prototype.slice,a={},s=0;n.setTimeout=function(){return new o(u.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new o(u.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,n){clearTimeout(t._idleTimeoutId),t._idleTimeout=n},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var n=t._idleTimeout;n>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},n))},n.setImmediate="function"==typeof t?t:function(t){var e=s++,r=arguments.length<2?!1:c.call(arguments,1);return a[e]=!0,i(function(){a[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))}),e},n.clearImmediate="function"==typeof r?r:function(t){delete a[t]}}).call(n,e(18).setImmediate,e(18).clearImmediate)},function(t,n,e){var r=e(8),o=e(1)("toStringTag"),i="Arguments"==r(function(){return arguments}());t.exports=function(t){var n,e,u;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(e=(n=Object(t))[o])?e:i?r(n):"Object"==(u=r(n))&&"function"==typeof n.callee?"Arguments":u}},function(t,n){t.exports=function(t){try{return!!t()}catch(n){return!0}}},function(t,n){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},function(t,n,e){"use strict";var r=e(23),o=e(15),i=e(25),u=e(16),c=e(21),a=e(7),s=e(41),f=e(17),l=e(4).getProto,h=e(1)("iterator"),d=!([].keys&&"next"in[].keys()),p="@@iterator",v="keys",y="values",m=function(){return this};t.exports=function(t,n,e,g,b,_,w){s(e,n,g);var x,S,k=function(t){if(!d&&t in T)return T[t];switch(t){case v:return function(){return new e(this,t)};case y:return function(){return new e(this,t)}}return function(){return new e(this,t)}},P=n+" Iterator",O=b==y,D=!1,T=t.prototype,E=T[h]||T[p]||b&&T[b],j=E||k(b);if(E){var C=l(j.call(new t));f(C,P,!0),!r&&c(T,p)&&u(C,h,m),O&&E.name!==y&&(D=!0,j=function(){return E.call(this)})}if(r&&!w||!d&&!D&&T[h]||u(T,h,j),a[n]=j,a[P]=m,b)if(x={values:O?j:k(y),keys:_?j:k(v),entries:O?k("entries"):j},w)for(S in x)S in T||i(T,S,x[S]);else o(o.P+o.F*(d||D),n,x);return x}},function(t,n){t.exports=!0},function(t,n){t.exports=function(t,n){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:n}}},function(t,n,e){t.exports=e(16)},function(t,n){var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},function(t,n,e){"use strict";function r(){function t(t){return h.patients.get(""+t).then(function(n){if(n)return e(n);throw"I say, this patient is not found #"+t})}function n(t,n){return h.patients.where("[mainFile.entryyear+mainFile.entryorder]").equals([""+t,""+n]).toArray(function(r){if(r&&1==r.length)return e(r[0]);throw"I say, reference not found #"+t+"."+n})}function e(t){return t}function r(t){var n="checkpoint";return t===!1?s(n,""):""==t?o.resolve(""):a(n,"").then(function(e){return!e||t>e?s(n,t):e})}function i(t){var n,e;return t._deleted?(n=h.patients["delete"](""+t.id),e=""+t.id):(t.record.id+="",t.record.mainFile.entryyear+="",t.record.mainFile.entryorder+="",n=h.patients.put(t.record),e=t.record),n.then(function(){return r(t.checkpoint)}),n.then(function(){return e})}function u(t,n){var e=o.resolve();for(var r in t)e=e.then(function(e){return new o(function(r,o){i(t[e]).then(function(t){n&&n(t),r()},function(t){o(t)})})}(r));return e}function a(t,n){return h.settings.get(""+t).then(function(t){return t?t.value:n=n||!1})}function s(t,n){return h.settings.put({key:""+t,value:n}).then(function(){return n})}function f(){return h.patients.clear().then(function(){return h.settings.clear()})}function l(){return h.verno}var h=new c["default"]("cryptomedic");return h.version(1).stores({patients:"++id"}),h.version(2).stores({patients:"++id,[mainFile.entryyear+mainFile.entryorder]"}),h.version(3).stores({patients:"++id"}),h.version(4).stores({patients:"++id,[mainFile.entryyear+mainFile.entryorder]"}),h.version(5).upgrade(function(t){t.patients.toCollection().modify(function(t){"number"==typeof t.id&&delete this.value,t.id=""+t.id})}),h.version(6).stores({patients:"++id,[mainFile.entryyear+mainFile.entryorder]",settings:"key"}),h.open(),{getFolder:t,getByReference:n,storeRecord:i,bulkUpdate:u,updateCheckpoint:r,getSetting:a,setSetting:s,clear:f,version:l}}var o=e(10)["default"],i=e(11)["default"];Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var u=e(66),c=i(u);t.exports=n["default"]},function(t,n,e){"use strict";function r(t,n,e){if(n=n||{},n.method||(n.method="GET"),n.credentials="include","/"!=t[0]&&(t="/"+location.pathname.split("/")[1]+"/api/v1.0/"+t),e)if("POST"==n.method){var r=new FormData;for(var o in e)r.append(o,e[o]);n.body=r}else if("PUT"==n.method){n.headers||(n.headers={}),n.headers["Content-type"]="application/x-www-form-urlencoded; charset=UTF-8";var c=function(t){return i(t).map(function(n){return encodeURIComponent(n)+"="+encodeURIComponent(t[n])}).join("&")};n.body=c(e)}else{t+="?";for(var a in e)t=t+encodeURIComponent(a)+"="+encodeURIComponent(e[a])+"&"}var s=new Request(t,n);return fetch(s).then(function(t){return t.ok?t.json():u.reject(t.status)})}function o(t,n,e){return r(t,n,e).then(function(t){return appState().dispatch(appState().catalog.CONNECTION_SUCCESS),t._offline?db.storeRecord({record:t}).then(function(){return t}):t},function(t){switch(t){case 401:appState().dispatch(appState().catalog.CONNECTION_EXPIRED),location.hash="#/login";break;case 403:appState().dispatch(appState().catalog.CONNECTION_FAILED);break;case 404:appState().dispatch(appState().catalog.CONNECTION_SERVER_ERROR);break;case 500:appState().dispatch(appState().catalog.CONNECTION_SERVER_ERROR);break;default:appState().dispatch(appState().catalog.CONNECTION_SERVER_ERROR)}return u.reject("myFrontFetch error: "+t)})}var i=e(30)["default"],u=e(10)["default"],c=e(11)["default"];Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r,n.myFrontFetch=o;var a=e(29);c(a)},function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var e={_define:function(t){e[t]=t}};n["default"]=e,t.exports=n["default"]},function(t,n,e){t.exports={"default":e(31),__esModule:!0}},function(t,n,e){e(61),t.exports=e(3).Object.keys},function(t,n,e){e(62),e(64),e(65),e(63),t.exports=e(3).Promise},function(t,n){t.exports=function(){}},function(t,n,e){var r=e(9),o=e(2).document,i=r(o)&&r(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,n,e){var r=e(6),o=e(40),i=e(39),u=e(5),c=e(56),a=e(59);t.exports=function(t,n,e,s){var f,l,h,d=a(t),p=r(e,s,n?2:1),v=0;if("function"!=typeof d)throw TypeError(t+" is not iterable!");if(i(d))for(f=c(t.length);f>v;v++)n?p(u(l=t[v])[0],l[1]):p(t[v]);else for(h=d.call(t);!(l=h.next()).done;)o(h,p,l.value,n)}},function(t,n,e){t.exports=e(2).document&&document.documentElement},function(t,n){t.exports=function(t,n,e){var r=void 0===e;switch(n.length){case 0:return r?t():t.call(e);case 1:return r?t(n[0]):t.call(e,n[0]);case 2:return r?t(n[0],n[1]):t.call(e,n[0],n[1]);case 3:return r?t(n[0],n[1],n[2]):t.call(e,n[0],n[1],n[2]);case 4:return r?t(n[0],n[1],n[2],n[3]):t.call(e,n[0],n[1],n[2],n[3])}return t.apply(e,n)}},function(t,n,e){var r=e(8);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,n,e){var r=e(7),o=e(1)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||i[o]===t)}},function(t,n,e){var r=e(5);t.exports=function(t,n,e,o){try{return o?n(r(e)[0],e[1]):n(e)}catch(i){var u=t["return"];throw void 0!==u&&r(u.call(t)),i}}},function(t,n,e){"use strict";var r=e(4),o=e(24),i=e(17),u={};e(16)(u,e(1)("iterator"),function(){return this}),t.exports=function(t,n,e){t.prototype=r.create(u,{next:o(1,e)}),i(t,n+" Iterator")}},function(t,n,e){var r=e(1)("iterator"),o=!1;try{var i=[7][r]();i["return"]=function(){o=!0},Array.from(i,function(){throw 2})}catch(u){}t.exports=function(t,n){if(!n&&!o)return!1;var e=!1;try{var i=[7],u=i[r]();u.next=function(){e=!0},i[r]=function(){return u},t(i)}catch(c){}return e}},function(t,n){t.exports=function(t,n){return{value:n,done:!!t}}},function(t,n,e){var r,o,i,u=e(2),c=e(54).set,a=u.MutationObserver||u.WebKitMutationObserver,s=u.process,f=u.Promise,l="process"==e(8)(s),h=function(){var t,n,e;for(l&&(t=s.domain)&&(s.domain=null,t.exit());r;)n=r.domain,e=r.fn,n&&n.enter(),e(),n&&n.exit(),r=r.next;o=void 0,t&&t.enter()};if(l)i=function(){s.nextTick(h)};else if(a){var d=1,p=document.createTextNode("");new a(h).observe(p,{characterData:!0}),i=function(){p.data=d=-d}}else i=f&&f.resolve?function(){f.resolve().then(h)}:function(){c.call(u,h)};t.exports=function(t){var n={fn:t,next:void 0,domain:l&&s.domain};o&&(o.next=n),r||(r=n,i()),o=n}},function(t,n,e){var r=e(15),o=e(3),i=e(20);t.exports=function(t,n){var e=(o.Object||{})[t]||Object[t],u={};u[t]=n(e),r(r.S+r.F*i(function(){e(1)}),"Object",u)}},function(t,n,e){var r=e(25);t.exports=function(t,n){for(var e in n)r(t,e,n[e]);return t}},function(t,n){t.exports=Object.is||function(t,n){return t===n?0!==t||1/t===1/n:t!=t&&n!=n}},function(t,n,e){var r=e(4).getDesc,o=e(9),i=e(5),u=function(t,n){if(i(t),!o(n)&&null!==n)throw TypeError(n+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,n,o){try{o=e(6)(Function.call,r(Object.prototype,"__proto__").set,2),o(t,[]),n=!(t instanceof Array)}catch(i){n=!0}return function(t,e){return u(t,e),n?t.__proto__=e:o(t,e),t}}({},!1):void 0),check:u}},function(t,n,e){"use strict";var r=e(3),o=e(4),i=e(14),u=e(1)("species");t.exports=function(t){var n=r[t];i&&n&&!n[u]&&o.setDesc(n,u,{configurable:!0,get:function(){return this}})}},function(t,n,e){var r=e(2),o="__core-js_shared__",i=r[o]||(r[o]={});t.exports=function(t){return i[t]||(i[t]={})}},function(t,n,e){var r=e(5),o=e(12),i=e(1)("species");t.exports=function(t,n){var e,u=r(t).constructor;return void 0===u||void 0==(e=r(u)[i])?n:o(e)}},function(t,n){t.exports=function(t,n,e){if(!(t instanceof n))throw TypeError(e+": use the 'new' operator!");return t}},function(t,n,e){var r=e(26),o=e(13);t.exports=function(t){return function(n,e){var i,u,c=String(o(n)),a=r(e),s=c.length;return 0>a||a>=s?t?"":void 0:(i=c.charCodeAt(a),55296>i||i>56319||a+1===s||(u=c.charCodeAt(a+1))<56320||u>57343?t?c.charAt(a):i:t?c.slice(a,a+2):(i-55296<<10)+(u-56320)+65536)}}},function(t,n,e){var r,o,i,u=e(6),c=e(37),a=e(36),s=e(34),f=e(2),l=f.process,h=f.setImmediate,d=f.clearImmediate,p=f.MessageChannel,v=0,y={},m="onreadystatechange",g=function(){var t=+this;if(y.hasOwnProperty(t)){var n=y[t];delete y[t],n()}},b=function(t){g.call(t.data)};h&&d||(h=function(t){for(var n=[],e=1;arguments.length>e;)n.push(arguments[e++]);return y[++v]=function(){c("function"==typeof t?t:Function(t),n)},r(v),v},d=function(t){delete y[t]},"process"==e(8)(l)?r=function(t){l.nextTick(u(g,t,1))}:p?(o=new p,i=o.port2,o.port1.onmessage=b,r=u(i.postMessage,i,1)):f.addEventListener&&"function"==typeof postMessage&&!f.importScripts?(r=function(t){f.postMessage(t+"","*")},f.addEventListener("message",b,!1)):r=m in s("script")?function(t){a.appendChild(s("script"))[m]=function(){a.removeChild(this),g.call(t)}}:function(t){setTimeout(u(g,t,1),0)}),t.exports={set:h,clear:d}},function(t,n,e){var r=e(38),o=e(13);t.exports=function(t){return r(o(t))}},function(t,n,e){var r=e(26),o=Math.min;t.exports=function(t){return t>0?o(r(t),9007199254740991):0}},function(t,n,e){var r=e(13);t.exports=function(t){return Object(r(t))}},function(t,n){var e=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+r).toString(36))}},function(t,n,e){var r=e(19),o=e(1)("iterator"),i=e(7);t.exports=e(3).getIteratorMethod=function(t){return void 0!=t?t[o]||t["@@iterator"]||i[r(t)]:void 0}},function(t,n,e){"use strict";var r=e(33),o=e(43),i=e(7),u=e(55);t.exports=e(22)(Array,"Array",function(t,n){this._t=u(t),this._i=0,this._k=n},function(){var t=this._t,n=this._k,e=this._i++;return!t||e>=t.length?(this._t=void 0,o(1)):"keys"==n?o(0,e):"values"==n?o(0,t[e]):o(0,[e,t[e]])},"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},function(t,n,e){var r=e(57);e(45)("keys",function(t){return function(n){return t(r(n))}})},function(t,n){},function(t,n,e){"use strict";var r,o=e(4),i=e(23),u=e(2),c=e(6),a=e(19),s=e(15),f=e(9),l=e(5),h=e(12),d=e(52),p=e(35),v=e(48).set,y=e(47),m=e(1)("species"),g=e(51),b=e(44),_="Promise",w=u.process,x="process"==a(w),S=u[_],k=function(t){var n=new S(function(){});return t&&(n.constructor=Object),S.resolve(n)===n},P=function(){function t(n){var e=new S(n);return v(e,t.prototype),e}var n=!1;try{if(n=S&&S.resolve&&k(),v(t,S),t.prototype=o.create(S.prototype,{constructor:{value:t}}),t.resolve(5).then(function(){})instanceof t||(n=!1),n&&e(14)){var r=!1;S.resolve(o.setDesc({},"then",{get:function(){r=!0}})),n=r}}catch(i){n=!1}return n}(),O=function(t,n){return i&&t===S&&n===r?!0:y(t,n)},D=function(t){var n=l(t)[m];return void 0!=n?n:t},T=function(t){var n;return f(t)&&"function"==typeof(n=t.then)?n:!1},E=function(t){var n,e;this.promise=new t(function(t,r){if(void 0!==n||void 0!==e)throw TypeError("Bad Promise constructor");n=t,e=r}),this.resolve=h(n),this.reject=h(e)},j=function(t){try{t()}catch(n){return{error:n}}},C=function(t,n){if(!t.n){t.n=!0;var e=t.c;b(function(){for(var r=t.v,o=1==t.s,i=0,c=function(n){var e,i,u=o?n.ok:n.fail,c=n.resolve,a=n.reject;try{u?(o||(t.h=!0),e=u===!0?r:u(r),e===n.promise?a(TypeError("Promise-chain cycle")):(i=T(e))?i.call(e,c,a):c(e)):a(r)}catch(s){a(s)}};e.length>i;)c(e[i++]);e.length=0,t.n=!1,n&&setTimeout(function(){var n,e,o=t.p;I(o)&&(x?w.emit("unhandledRejection",r,o):(n=u.onunhandledrejection)?n({promise:o,reason:r}):(e=u.console)&&e.error&&e.error("Unhandled promise rejection",r)),t.a=void 0},1)})}},I=function(t){var n,e=t._d,r=e.a||e.c,o=0;if(e.h)return!1;for(;r.length>o;)if(n=r[o++],n.fail||!I(n.promise))return!1;return!0},A=function(t){var n=this;n.d||(n.d=!0,n=n.r||n,n.v=t,n.s=2,n.a=n.c.slice(),C(n,!0))},N=function(t){var n,e=this;if(!e.d){e.d=!0,e=e.r||e;try{if(e.p===t)throw TypeError("Promise can't be resolved itself");(n=T(t))?b(function(){var r={r:e,d:!1};try{n.call(t,c(N,r,1),c(A,r,1))}catch(o){A.call(r,o)}}):(e.v=t,e.s=1,C(e,!1))}catch(r){A.call({r:e,d:!1},r)}}};P||(S=function(t){h(t);var n=this._d={p:d(this,S,_),c:[],a:void 0,s:0,d:!1,v:void 0,h:!1,n:!1};try{t(c(N,n,1),c(A,n,1))}catch(e){A.call(n,e)}},e(46)(S.prototype,{then:function(t,n){var e=new E(g(this,S)),r=e.promise,o=this._d;return e.ok="function"==typeof t?t:!0,e.fail="function"==typeof n&&n,o.c.push(e),o.a&&o.a.push(e),o.s&&C(o,!1),r},"catch":function(t){return this.then(void 0,t)}})),s(s.G+s.W+s.F*!P,{Promise:S}),e(17)(S,_),e(49)(_),r=e(3)[_],s(s.S+s.F*!P,_,{reject:function(t){var n=new E(this),e=n.reject;return e(t),n.promise}}),s(s.S+s.F*(!P||k(!0)),_,{resolve:function(t){if(t instanceof S&&O(t.constructor,this))return t;var n=new E(this),e=n.resolve;return e(t),n.promise}}),s(s.S+s.F*!(P&&e(42)(function(t){S.all(t)["catch"](function(){})})),_,{all:function(t){var n=D(this),e=new E(n),r=e.resolve,i=e.reject,u=[],c=j(function(){p(t,!1,u.push,u);var e=u.length,c=Array(e);e?o.each.call(u,function(t,o){var u=!1;n.resolve(t).then(function(t){u||(u=!0,c[o]=t,--e||r(c))},i)}):r(c)});return c&&i(c.error),e.promise},race:function(t){var n=D(this),e=new E(n),r=e.reject,o=j(function(){p(t,!1,function(t){n.resolve(t).then(e.resolve,r)})});return o&&r(o.error),e.promise}})},function(t,n,e){"use strict";var r=e(53)(!0);e(22)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,n=this._t,e=this._i;return e>=n.length?{value:void 0,done:!0}:(t=r(n,e),this._i+=t.length,{value:t,done:!1})})},function(t,n,e){e(60);var r=e(7);r.NodeList=r.HTMLCollection=r.Array},function(t,n,e){var r;(function(o){(function(t,n,e){"use strict";function r(t,n){return"object"!=typeof n&&(n=n()),Object.keys(n).forEach(function(e){t[e]=n[e]}),t}function i(t){return{from:function(n){return t.prototype=Object.create(n.prototype),t.prototype.constructor=t,{extend:function(e){r(t.prototype,"object"!=typeof e?e(n.prototype):e)}}}}}function u(t,n){return n(t)}function c(t,n){function o(){Ot.on("versionchange",function(t){Ot.close(),Ot.on("error").fire(new pt("Database version changed by other database connection."))})}function l(t){this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function p(t,n,e,r){if(0===t){Object.keys(vt).forEach(function(t){w(n,t,vt[t].primKey,vt[t].indexes)});var o=Ot._createTransaction(Pt,mt,vt);o.idbtrans=n,o.idbtrans.onerror=C(e,["populating database"]),o.on("error").subscribe(e),U.newPSD(function(){U.PSD.trans=o;try{Ot.on("populate").fire(o)}catch(t){r.onerror=n.onerror=function(t){t.preventDefault()};try{n.abort()}catch(i){}n.db.close(),e(t)}})}else{var i=[],c=yt.filter(function(n){return n._cfg.version===t})[0];if(!c)throw new pt("Dexie specification of currently installed DB version is missing");vt=Ot._dbSchema=c._cfg.dbschema;var a=!1,s=yt.filter(function(n){return n._cfg.version>t});s.forEach(function(t){var r=vt,o=t._cfg.dbschema;at(r,n),at(o,n),vt=Ot._dbSchema=o;var c=b(r,o);c.add.forEach(function(t){i.push(function(n,e){w(n,t[0],t[1].primKey,t[1].indexes),e()})}),c.change.forEach(function(t){if(t.recreate)throw new pt("Not yet support for changing primary key");i.push(function(n,e){var r=n.objectStore(t.name);t.add.forEach(function(t){L(r,t)}),t.change.forEach(function(t){r.deleteIndex(t.name),L(r,t)}),t.del.forEach(function(t){r.deleteIndex(t)}),e()})}),t._cfg.contentUpgrade&&i.push(function(n,r){a=!0;var i=Ot._createTransaction(Pt,[].slice.call(n.db.objectStoreNames,0),o);i.idbtrans=n;var c=0;i._promise=u(i._promise,function(t){return function(n,e,o){function i(t){return function(){t.apply(this,arguments),0===--c&&r()}}return++c,t.call(this,n,function(t,n,r){arguments[0]=i(t),arguments[1]=i(n),e.apply(this,arguments)},o)}}),n.onerror=C(e,["running upgrader function for version",t._cfg.version]),i.on("error").subscribe(e),t._cfg.contentUpgrade(i),0===c&&r()}),a&&ut()||i.push(function(t,n){E(o,t),n()})});var f=function(){try{i.length?i.shift()(n,f):P(vt,n)}catch(t){r.onerror=n.onerror=function(t){t.preventDefault()};try{n.abort()}catch(o){}n.db.close(),e(t)}};f()}}function b(t,n){var e={del:[],add:[],change:[]};for(var r in t)n[r]||e.del.push(r);for(var r in n){var o=t[r],i=n[r];if(o){var u={name:r,def:n[r],recreate:!1,del:[],add:[],change:[]};if(o.primKey.src!==i.primKey.src)u.recreate=!0,e.change.push(u);else{var c=o.indexes.reduce(function(t,n){return t[n.name]=n,t},{}),a=i.indexes.reduce(function(t,n){return t[n.name]=n,t},{});for(var s in c)a[s]||u.del.push(s);for(var s in a){var f=c[s],l=a[s];f?f.src!==l.src&&u.change.push(l):u.add.push(l)}(u.recreate||u.del.length>0||u.add.length>0||u.change.length>0)&&e.change.push(u)}}else e.add.push([r,i])}return e}function w(t,n,e,r){var o=t.db.createObjectStore(n,e.keyPath?{keyPath:e.keyPath,autoIncrement:e.auto}:{autoIncrement:e.auto});return r.forEach(function(t){L(o,t)}),o}function P(t,n){Object.keys(t).forEach(function(e){n.db.objectStoreNames.contains(e)||w(n,e,t[e].primKey,t[e].indexes)})}function E(t,n){for(var r=0;r<n.db.objectStoreNames.length;++r){var o=n.db.objectStoreNames[r];(null===t[o]||t[o]===e)&&n.db.deleteObjectStore(o)}}function L(t,n){t.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function V(t,n){throw new pt("Table "+n[0]+" not part of transaction. Original Scope Function Source: "+c.Promise.PSD.trans.scopeFunc.toString())}function G(t,n,e,r){this.name=t,this.schema=e,this.hook=gt[t]?gt[t].hook:g(null,{creating:[h,a],reading:[f,s],updating:[d,a],deleting:[y,a]}),this._tpf=n,this._collClass=r||Y}function J(t,n,e,r){G.call(this,t,n,e,r||X)}function z(t,n,e,r){function o(t,n,e,r){return i._promise(t,e,r)}var i=this;this.db=Ot,this.mode=t,this.storeNames=n,this.idbtrans=null,this.on=g(this,["complete","error"],"abort"),this._reculock=0,this._blockedFuncs=[],this._psd=null,this.active=!0,this._dbschema=e,r&&(this.parent=r),this._tpf=o,this.tables=Object.create(bt);for(var u=n.length-1;-1!==u;--u){var c=n[u],a=Ot._tableFactory(t,e[c],o);this.tables[c]=a,this[c]||(this[c]=a)}}function H(t,n,e){this._ctx={table:t,index:":id"===n?null:n,collClass:t._collClass,or:e}}function Y(t,n){var e=null,r=null;if(n)try{e=n()}catch(o){r=o}var i=t._ctx;this._ctx={table:i.table,index:i.index,isPrimKey:!i.index||i.table.schema.primKey.keyPath&&i.index===i.table.schema.primKey.name,range:e,op:"openCursor",dir:"next",unique:"",algorithm:null,filter:null,isMatch:null,offset:0,limit:1/0,error:r,or:i.or}}function X(){Y.apply(this,arguments)}function Q(t,n){return t._cfg.version-n._cfg.version}function Z(t,n,e,r,o,i){e.forEach(function(e){var u=Ot._tableFactory(r,o[e],n);t.forEach(function(t){t[e]||(i?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){var t=U.PSD&&U.PSD.trans;return t&&t.db===Ot?t.tables[e]:u}}):t[e]=u)})})}function $(t){t.forEach(function(t){for(var n in t)t[n]instanceof G&&delete t[n]})}function tt(t,n,e,r,o,i){var u=U.PSD;i=i||s,t.onerror||(t.onerror=C(o)),n?t.onsuccess=x(function(u){var c=t.result;if(c){var a=function(){c["continue"]()};n(c,function(t){a=t},r,o)&&e(i(c.value),c,function(t){a=t}),a()}else r()},o,u):t.onsuccess=x(function(n){var o=t.result;if(o){var u=function(){o["continue"]()};e(i(o.value),o,function(t){u=t}),u()}else r()},o,u)}function nt(t){var n=[];return t.split(",").forEach(function(t){t=t.trim();var e=t.replace("&","").replace("++","").replace("*",""),r=0!==e.indexOf("[")?e:t.substring(t.indexOf("[")+1,t.indexOf("]")).split("+");n.push(new F(e,r||null,-1!==t.indexOf("&"),-1!==t.indexOf("*"),-1!==t.indexOf("++"),Array.isArray(r),-1!==r.indexOf(".")))}),n}function et(t,n){return n>t?-1:t>n?1:0}function rt(t,n){return n>t?1:t>n?-1:0}function ot(t){return function(n,e){for(var r=0;;){var o=t(n[r],e[r]);if(0!==o)return o;if(++r,r===n.length||r===e.length)return t(n.length,e.length)}}}function it(t,n){return t?n?function(){return t.apply(this,arguments)&&n.apply(this,arguments)}:t:n}function ut(){return navigator.userAgent.indexOf("Trident")>=0||navigator.userAgent.indexOf("MSIE")>=0}function ct(){if(Ot.verno=_t.version/10,Ot._dbSchema=vt={},mt=[].slice.call(_t.objectStoreNames,0),0!==mt.length){var t=_t.transaction(B(mt),"readonly");mt.forEach(function(n){for(var e=t.objectStore(n),r=e.keyPath,o=r&&"string"==typeof r&&-1!==r.indexOf("."),i=new F(r,r||"",!1,!1,!!e.autoIncrement,r&&"string"!=typeof r,o),u=[],c=0;c<e.indexNames.length;++c){var a=e.index(e.indexNames[c]);r=a.keyPath,o=r&&"string"==typeof r&&-1!==r.indexOf(".");var s=new F(a.name,r,!!a.unique,!!a.multiEntry,!1,r&&"string"!=typeof r,o);u.push(s)}vt[n]=new K(n,i,u,{})}),Z([gt],Ot._transPromiseFactory,Object.keys(vt),Pt,vt)}}function at(t,n){for(var e=n.db.objectStoreNames,r=0;r<e.length;++r)for(var o=e[r],i=n.objectStore(o),u=0;u<i.indexNames.length;++u){var c=i.indexNames[u],a=i.index(c).keyPath,s="string"==typeof a?a:"["+[].slice.call(a).join("+")+"]";if(t[o]){var f=t[o].idxByName[s];f&&(f.name=c)}}}var st=n&&n.addons||c.addons,ft=c.dependencies,lt=ft.indexedDB,ht=ft.IDBKeyRange,dt=(ft.IDBTransaction,ft.DOMError,ft.TypeError),pt=ft.Error,vt=this._dbSchema={},yt=[],mt=[],gt={},bt={},_t=null,wt=!0,xt=null,St=!1,kt="readonly",Pt="readwrite",Ot=this,Dt=[],Tt=!0,Et=!!R();this.version=function(t){if(_t)throw new pt("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=yt.filter(function(n){return n._cfg.version===t})[0];return n?n:(n=new l(t),yt.push(n),yt.sort(Q),n)},r(l.prototype,{stores:function(t){this._cfg.storesSource=this._cfg.storesSource?r(this._cfg.storesSource,t):t;var n={};yt.forEach(function(t){r(n,t._cfg.storesSource)});var e=this._cfg.dbschema={};return this._parseStoresSpec(n,e),vt=Ot._dbSchema=e,$([gt,Ot,bt]),Z([bt],V,Object.keys(e),Pt,e),Z([gt,Ot,this._cfg.tables],Ot._transPromiseFactory,Object.keys(e),Pt,e,!0),mt=Object.keys(e),this},upgrade:function(t){var n=this;return q(function(){t(Ot._createTransaction(Pt,Object.keys(n._cfg.dbschema),n._cfg.dbschema))}),this._cfg.contentUpgrade=t,this},_parseStoresSpec:function(t,n){Object.keys(t).forEach(function(e){if(null!==t[e]){var r={},o=nt(t[e]),i=o.shift();if(i.multi)throw new pt("Primary key cannot be multi-valued");i.keyPath&&k(r,i.keyPath,i.auto?0:i.keyPath),o.forEach(function(t){if(t.auto)throw new pt("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new pt("Index must have a name and cannot be an empty string");k(r,t.keyPath,t.compound?t.keyPath.map(function(){return""}):"")}),n[e]=new K(e,i,o,r)}})}}),this._allTables=gt,this._tableFactory=function(t,n,e){return t===kt?new G(n.name,e,n,Y):new J(n.name,e,n)},this._createTransaction=function(t,n,e,r){return new z(t,n,e,r)},this._transPromiseFactory=function(t,n,e){if(!wt||U.PSD&&U.PSD.letThrough){var r=Ot._createTransaction(t,n,vt);return r._promise(t,function(t,n){r.error(function(t){Ot.on("error").fire(t)}),e(function(n){r.complete(function(){t(n)})},n,r)})}var o=new U(function(r,i){Dt.push({resume:function(){var u=Ot._transPromiseFactory(t,n,e);o.onuncatched=u.onuncatched,u.then(r,i)}})});return o},this._whenReady=function(t){return new U(W||!wt||U.PSD&&U.PSD.letThrough?t:function(n,e){Dt.push({resume:function(){t(n,e)}})})},this.verno=0,this.open=function(){return new U(function(n,e){function r(t){try{o.transaction.abort()}catch(n){}St=!1,xt=t,wt=!1,e(xt),Dt.forEach(function(t){t.resume()}),Dt=[]}if(W&&n(Ot),_t||St)throw new pt("Database already opened or being opened");var o,i=!1;try{if(xt=null,St=!0,yt.length>0&&(Tt=!1),!lt)throw new pt("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using Safari, make sure to include indexedDB polyfill.");if(o=Tt?lt.open(t):lt.open(t,Math.round(10*Ot.verno)),!o)throw new pt("IndexedDB API not available");o.onerror=C(r,["opening database",t]),o.onblocked=function(t){Ot.on("blocked").fire(t)},o.onupgradeneeded=x(function(n){if(Tt&&!Ot._allowEmptyDB){o.onerror=function(t){t.preventDefault()},o.transaction.abort(),o.result.close();var e=lt.deleteDatabase(t);e.onsuccess=e.onerror=function(){r(new pt("Database '"+t+"' doesnt exist"))}}else{0===n.oldVersion&&(i=!0),o.transaction.onerror=C(r);var u=n.oldVersion>Math.pow(2,62)?0:n.oldVersion;p(u/10,o.transaction,r,o)}},r),o.onsuccess=x(function(e){St=!1,_t=o.result,Tt?ct():_t.objectStoreNames.length>0&&at(vt,_t.transaction(B(_t.objectStoreNames),kt)),_t.onversionchange=Ot.on("versionchange").fire,Et||N(function(n){return-1===n.indexOf(t)?n.push(t):void 0}),U.newPSD(function(){function t(){wt=!1,Dt.forEach(function(t){t.resume()}),Dt=[],n(Ot)}U.PSD.letThrough=!0;try{var e=Ot.on.ready.fire();e&&"function"==typeof e.then?e.then(t,function(t){_t.close(),_t=null,r(t)}):_(t)}catch(o){r(o)}})},r)}catch(u){r(u)}})},this.close=function(){_t&&(_t.close(),_t=null,wt=!0,xt=null)},this["delete"]=function(){var n=arguments;return new U(function(e,r){function o(){Ot.close();var n=lt.deleteDatabase(t);n.onsuccess=function(){Et||N(function(n){var e=n.indexOf(t);return e>=0?n.splice(e,1):void 0}),e()},n.onerror=C(r,["deleting",t]),n.onblocked=function(){Ot.on("blocked").fire()}}if(n.length>0)throw new pt("Arguments not allowed in db.delete()");St?Dt.push({resume:o}):o()})},this.backendDB=function(){return _t},this.isOpen=function(){return null!==_t},this.hasFailed=function(){return null!==xt},this.dynamicallyOpened=function(){return Tt},this.name=t,Object.defineProperty(this,"tables",{get:function(){return Object.keys(gt).map(function(t){
return gt[t]})}}),this.on=g(this,"error","populate","blocked",{ready:[m,a],versionchange:[v,a]}),this.on.ready.subscribe=u(this.on.ready.subscribe,function(t){return function(n,e){function r(){return e||Ot.on.ready.unsubscribe(r),n.apply(this,arguments)}t.call(this,r),Ot.isOpen()&&(wt?Dt.push({resume:r}):r())}}),q(function(){Ot.on("populate").fire(Ot._createTransaction(Pt,mt,vt)),Ot.on("error").fire(new pt)}),this.transaction=function(t,n,e){function r(n,r){var i=null;try{if(a)throw a;i=Ot._createTransaction(t,s,vt,o);var c=s.map(function(t){return i.tables[t]});c.push(i);var f,l=0;U.newPSD(function(){U.PSD.trans=i,i.scopeFunc=e,o&&(i.idbtrans=o.idbtrans,i._promise=u(i._promise,function(t){return function(n,e,r){function o(t){return function(n){var e;return U._rootExec(function(){e=t(n),U._tickFinalize(function(){0===--l&&i.active&&(i.active=!1,i.on.complete.fire())})}),e}}return++l,t.call(this,n,function(t,n,r){return e(o(t),o(n),r)},r)}})),i.complete(function(){n(f)}),i.error(function(t){i.idbtrans&&(i.idbtrans.onerror=A);try{i.abort()}catch(n){}o&&(o.active=!1,o.on.error.fire(t));var e=r(t);o||e||Ot.on.error.fire(t)}),U._rootExec(function(){f=e.apply(i,c)})}),(!i.idbtrans||o&&0===l)&&i._nop()}catch(h){i&&i.idbtrans&&(i.idbtrans.onerror=A),i&&i.abort(),o&&o.on.error.fire(h),_(function(){r(h)||Ot.on("error").fire(h)})}}n=[].slice.call(arguments,1,arguments.length-1),e=arguments[arguments.length-1];var o=U.PSD&&U.PSD.trans;o&&o.db===Ot&&-1===t.indexOf("!")||(o=null);var i=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");var c=Array.isArray(n[0])?n.reduce(function(t,n){return t.concat(n)}):n,a=null,s=c.map(function(t){return"string"==typeof t?t:(t instanceof G||(a=a||new dt("Invalid type. Arguments following mode must be instances of Table or String")),t.name)});return"r"==t||t==kt?t=kt:"rw"==t||t==Pt?t=Pt:a=new pt("Invalid transaction mode: "+t),o&&(a||(o&&o.mode===kt&&t===Pt&&(i?o=null:a=a||new pt("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY")),o&&s.forEach(function(t){o.tables.hasOwnProperty(t)||(i?o=null:a=a||new pt("Table "+t+" not included in parent transaction. Parent Transaction function: "+o.scopeFunc.toString()))}))),o?o._promise(t,r,"lock"):Ot._whenReady(r)},this.table=function(t){if(W&&Tt)return new J(t);if(!gt.hasOwnProperty(t))throw new pt("Table does not exist");return gt[t]},r(G.prototype,function(){function t(){throw new pt("Current Transaction is READONLY")}return{_trans:function(t,n,e){return this._tpf(t,[this.name],n,e)},_idbstore:function(t,n,e){if(W)return new U(n);var r=this;return this._tpf(t,[this.name],function(t,e,o){n(t,e,o.idbtrans.objectStore(r.name),o)},e)},get:function(t,n){var e=this;return this._idbstore(kt,function(n,r,o){W&&n(e.schema.instanceTemplate);var i=o.get(t);i.onerror=C(r,["getting",t,"from",e.name]),i.onsuccess=function(){n(e.hook.reading.fire(i.result))}}).then(n)},where:function(t){return new H(this,t)},count:function(t){return this.toCollection().count(t)},offset:function(t){return this.toCollection().offset(t)},limit:function(t){return this.toCollection().limit(t)},reverse:function(){return this.toCollection().reverse()},filter:function(t){return this.toCollection().and(t)},each:function(t){var n=this;return W&&t(n.schema.instanceTemplate),this._idbstore(kt,function(e,r,o){var i=o.openCursor();i.onerror=C(r,["calling","Table.each()","on",n.name]),tt(i,null,t,e,r,n.hook.reading.fire)})},toArray:function(t){var n=this;return this._idbstore(kt,function(t,e,r){W&&t([n.schema.instanceTemplate]);var o=[],i=r.openCursor();i.onerror=C(e,["calling","Table.toArray()","on",n.name]),tt(i,null,function(t){o.push(t)},function(){t(o)},e,n.hook.reading.fire)}).then(t)},orderBy:function(t){return new this._collClass(new H(this,t))},toCollection:function(){return new this._collClass(new H(this))},mapToClass:function(t,n){this.schema.mappedClass=t;var e=Object.create(t.prototype);n&&j(e,n),this.schema.instanceTemplate=e;var r=function(n){if(!n)return n;var e=Object.create(t.prototype);for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t},defineClass:function(t){return this.mapToClass(c.defineClass(t),t)},add:t,put:t,"delete":t,clear:t,update:t}}),i(J).from(G).extend(function(){return{add:function(t,n){var r=this,o=this.hook.creating.fire;return this._idbstore(Pt,function(i,u,c,s){var f={};if(o!==a){var l=n||(c.keyPath?S(t,c.keyPath):e),h=o.call(f,l,t,s);l===e&&h!==e&&(c.keyPath?k(t,c.keyPath,h):n=h)}var d=n?c.add(t,n):c.add(t);d.onerror=C(function(t){return f.onerror&&f.onerror(t),u(t)},["adding",t,"into",r.name]),d.onsuccess=function(n){var e=c.keyPath;e&&k(t,e,n.target.result),f.onsuccess&&f.onsuccess(n.target.result),i(d.result)}})},put:function(t,n){var r=this,o=this.hook.creating.fire,i=this.hook.updating.fire;return o!==a||i!==a?this._trans(Pt,function(o,i,u){var c=n||r.schema.primKey.keyPath&&S(t,r.schema.primKey.keyPath);c===e?u.tables[r.name].add(t).then(o,i):(u._lock(),t=D(t),u.tables[r.name].where(":id").equals(c).modify(function(n){this.value=t}).then(function(e){return 0===e?u.tables[r.name].add(t,n):c})["finally"](function(){u._unlock()}).then(o,i))}):this._idbstore(Pt,function(e,o,i){var u=n?i.put(t,n):i.put(t);u.onerror=C(o,["putting",t,"into",r.name]),u.onsuccess=function(n){var r=i.keyPath;r&&k(t,r,n.target.result),e(u.result)}})},"delete":function(t){return this.hook.deleting.subscribers.length?this.where(":id").equals(t)["delete"]():this._idbstore(Pt,function(n,e,r){var o=r["delete"](t);o.onerror=C(e,["deleting",t,"from",r.name]),o.onsuccess=function(t){n(o.result)}})},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection()["delete"]():this._idbstore(Pt,function(t,n,e){var r=e.clear();r.onerror=C(n,["clearing",e.name]),r.onsuccess=function(n){t(r.result)}})},update:function(t,n){if("object"!=typeof n||Array.isArray(n))throw new pt("db.update(keyOrObject, modifications). modifications must be an object.");if("object"!=typeof t||Array.isArray(t))return this.where(":id").equals(t).modify(n);Object.keys(n).forEach(function(e){k(t,e,n[e])});var r=S(t,this.schema.primKey.keyPath);return r===e&&U.reject(new pt("Object does not contain its primary key")),this.where(":id").equals(r).modify(n)}}}),r(z.prototype,{_lock:function(){return++this._reculock,1===this._reculock&&U.PSD&&(U.PSD.lockOwnerFor=this),this},_unlock:function(){if(0===--this._reculock)for(U.PSD&&(U.PSD.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{t()}catch(n){}}return this},_locked:function(){return this._reculock&&(!U.PSD||U.PSD.lockOwnerFor!==this)},_nop:function(t){this.tables[this.storeNames[0]].get(0).then(t)},_promise:function(t,n,e){var r=this;return U.newPSD(function(){var o;return r._locked()?o=new U(function(o,i){r._blockedFuncs.push(function(){r._promise(t,n,e).then(o,i)})}):(o=r.active?new U(function(o,i){if(!r.idbtrans&&t){if(!_t)throw new pt(xt?"Database not open. Following error in populate, ready or upgrade function made Dexie.open() fail: "+xt:"Database not open");var u=r.idbtrans=_t.transaction(B(r.storeNames),r.mode);u.onerror=function(t){r.on("error").fire(t&&t.target.error),t.preventDefault(),r.abort()},u.onabort=function(t){_(function(){r.on("error").fire(new pt("Transaction aborted for unknown reason"))}),r.active=!1,r.on("abort").fire(t)},u.oncomplete=function(t){r.active=!1,r.on("complete").fire(t)}}e&&r._lock();try{n(o,i,r)}catch(a){c.ignoreTransaction(function(){r.on("error").fire(a)}),r.abort(),i(a)}}):U.reject(I(new pt("Transaction is inactive. Original Scope Function Source: "+r.scopeFunc.toString()))),r.active&&e&&o["finally"](function(){r._unlock()})),o.onuncatched=function(t){c.ignoreTransaction(function(){r.on("error").fire(t)}),r.abort()},o})},complete:function(t){return this.on("complete",t)},error:function(t){return this.on("error",t)},abort:function(){if(this.idbtrans&&this.active)try{this.active=!1,this.idbtrans.abort(),this.on.error.fire(new pt("Transaction Aborted"))}catch(t){}},table:function(t){if(!this.tables.hasOwnProperty(t))throw new pt("Table "+t+" not in transaction");return this.tables[t]}}),r(H.prototype,function(){function t(t,n){try{throw n}catch(e){t._ctx.error=e}return t}function n(t){return Array.prototype.slice.call(1===t.length&&Array.isArray(t[0])?t[0]:t)}function e(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function r(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function o(t,n,e,r,o,i){for(var u=Math.min(t.length,r.length),c=-1,a=0;u>a;++a){var s=n[a];if(s!==r[a])return o(t[a],e[a])<0?t.substr(0,a)+e[a]+e.substr(a+1):o(t[a],r[a])<0?t.substr(0,a)+r[a]+e.substr(a+1):c>=0?t.substr(0,c)+n[c]+e.substr(c+1):null;o(t[a],s)<0&&(c=a)}return u<r.length&&"next"===i?t+e.substr(t.length):u<t.length&&"prev"===i?t.substr(0,e.length):0>c?null:t.substr(0,c)+r[c]+e.substr(c+1)}function i(t,n,i){function u(t){c=e(t),a=r(t),s="next"===t?et:rt,f=c(i),l=a(i),h=t}var c,a,s,f,l,h;u("next"),t._ondirectionchange=function(t){u(t)},t._addAlgorithm(function(t,e,r){var i=t.key;if("string"!=typeof i)return!1;var u=a(i);if(n(u,l))return e(function(){t["continue"]()}),!0;var c=o(i,u,f,l,s,h);return e(c?function(){t["continue"](c)}:r),!1})}return{between:function(t,n,e,r){return e=e!==!1,r=r===!0,t>n||t===n&&(e||r)&&(!e||!r)?new this._ctx.collClass(this,function(){return ht.only(t)}).limit(0):new this._ctx.collClass(this,function(){return ht.bound(t,n,!e,!r)})},equals:function(t){return new this._ctx.collClass(this,function(){return ht.only(t)})},above:function(t){return new this._ctx.collClass(this,function(){return ht.lowerBound(t,!0)})},aboveOrEqual:function(t){return new this._ctx.collClass(this,function(){return ht.lowerBound(t)})},below:function(t){return new this._ctx.collClass(this,function(){return ht.upperBound(t,!0)})},belowOrEqual:function(t){return new this._ctx.collClass(this,function(){return ht.upperBound(t)})},startsWith:function(n){return"string"!=typeof n?t(new this._ctx.collClass(this),new dt("String expected")):this.between(n,n+String.fromCharCode(65535),!0,!0)},startsWithIgnoreCase:function(n){if("string"!=typeof n)return t(new this._ctx.collClass(this),new dt("String expected"));if(""===n)return this.startsWith(n);var e=new this._ctx.collClass(this,function(){return ht.bound(n.toUpperCase(),n.toLowerCase()+String.fromCharCode(65535))});return i(e,function(t,n){return 0===t.indexOf(n)},n),e._ondirectionchange=function(){t(e,new pt("reverse() not supported with WhereClause.startsWithIgnoreCase()"))},e},equalsIgnoreCase:function(n){if("string"!=typeof n)return t(new this._ctx.collClass(this),new dt("String expected"));var e=new this._ctx.collClass(this,function(){return ht.bound(n.toUpperCase(),n.toLowerCase())});return i(e,function(t,n){return t===n},n),e},anyOf:function(t){var e=this._ctx,r=e.table.schema,o=e.index?r.idxByName[e.index]:r.primKey,i=o&&o.compound,u=n(arguments),c=i?ot(et):et;if(u.sort(c),0===u.length)return new this._ctx.collClass(this,function(){return ht.only("")}).limit(0);var a=new this._ctx.collClass(this,function(){return ht.bound(u[0],u[u.length-1])});a._ondirectionchange=function(t){c="next"===t?et:rt,i&&(c=ot(c)),u.sort(c)};var s=0;return a._addAlgorithm(function(t,n,e){for(var r=t.key;c(r,u[s])>0;)if(++s,s===u.length)return n(e),!1;return 0===c(r,u[s])?(n(function(){t["continue"]()}),!0):(n(function(){t["continue"](u[s])}),!1)}),a},notEqual:function(t){return this.below(t).or(this._ctx.index).above(t)},noneOf:function(t){var e=this._ctx,r=e.table.schema,o=e.index?r.idxByName[e.index]:r.primKey,i=o&&o.compound,u=n(arguments);if(0===u.length)return new this._ctx.collClass(this);var c=i?ot(et):et;u.sort(c);var a=u.reduce(function(t,n){return t?t.concat([[t[t.length-1][1],n]]):[[null,n]]},null);a.push([u[u.length-1],null]);var s=this,f=e.index;return a.reduce(function(t,n){return t?null===n[1]?t.or(f).above(n[0]):t.or(f).between(n[0],n[1],!1,!1):s.below(n[1])},null)},startsWithAnyOf:function(e){function r(t){return t>c[s]}function o(t){return t<u[s]}var i=this._ctx,u=n(arguments);if(!u.every(function(t){return"string"==typeof t}))return t(new i.collClass(this),new dt("startsWithAnyOf() only works with strings"));if(0===u.length)return new i.collClass(this,function(){return ht.only("")}).limit(0);var c=u.map(function(t){return t+String.fromCharCode(65535)}),a=et;u.sort(a);var s=0,f=r,l=new i.collClass(this,function(){return ht.bound(u[0],u[u.length-1]+String.fromCharCode(65535))});return l._ondirectionchange=function(t){"next"===t?(f=r,a=et):(f=o,a=rt),u.sort(a),c.sort(a)},l._addAlgorithm(function(t,n,e){for(var r=t.key;f(r);)if(++s,s===u.length)return n(e),!1;return r>=u[s]&&r<=c[s]?(n(function(){t["continue"]()}),!0):(n(function(){a===et?t["continue"](u[s]):t["continue"](c[s])}),!1)}),l}}}),r(Y.prototype,function(){function t(t,n){t.filter=it(t.filter,n)}function n(t,n){t.isMatch=it(t.isMatch,n)}function e(t,n){if(t.isPrimKey)return n;var e=t.table.schema.idxByName[t.index];if(!e)throw new pt("KeyPath "+t.index+" on object store "+n.name+" is not indexed");return t.isPrimKey?n:n.index(e.name)}function r(t,n){return e(t,n)[t.op](t.range||null,t.dir+t.unique)}function o(t,n,e,o,i){t.or?!function(){function u(){2===++f&&e()}function c(t,e,r){if(!a||a(e,r,u,o)){var i=e.primaryKey.toString();s.hasOwnProperty(i)||(s[i]=!0,n(t,e,r))}}var a=t.filter,s={},f=(t.table.schema.primKey.keyPath,0);t.or._iterate(c,u,o,i),tt(r(t,i),t.algorithm,c,u,o,t.table.hook.reading.fire)}():tt(r(t,i),it(t.algorithm,t.filter),n,e,o,t.table.hook.reading.fire)}function i(t){return t.table.schema.instanceTemplate}return{_read:function(t,n){var e=this._ctx;return e.error?e.table._trans(null,function(t,n){n(e.error)}):e.table._idbstore(kt,t).then(n)},_write:function(t){var n=this._ctx;return n.error?n.table._trans(null,function(t,e){e(n.error)}):n.table._idbstore(Pt,t,"locked")},_addAlgorithm:function(t){var n=this._ctx;n.algorithm=it(n.algorithm,t)},_iterate:function(t,n,e,r){return o(this._ctx,t,n,e,r)},each:function(t){var n=this._ctx;return W&&t(i(n)),this._read(function(e,r,i){o(n,t,e,r,i)})},count:function(t){if(W)return U.resolve(0).then(t);var n=this,r=this._ctx;if(r.filter||r.algorithm||r.or){var i=0;return this._read(function(t,n,e){o(r,function(){return++i,!1},function(){t(i)},n,e)},t)}return this._read(function(t,o,i){var u=e(r,i),c=r.range?u.count(r.range):u.count();c.onerror=C(o,["calling","count()","on",n.name]),c.onsuccess=function(n){t(Math.min(n.target.result,Math.max(0,r.limit-r.offset)))}},t)},sortBy:function(t,n){function e(t,n){return n?e(t[o[n]],n-1):t[i]}function r(t,n){var r=e(t,u),o=e(n,u);return o>r?-c:r>o?c:0}var o=(this._ctx,t.split(".").reverse()),i=o[0],u=o.length-1,c="next"===this._ctx.dir?1:-1;return this.toArray(function(t){return t.sort(r)}).then(n)},toArray:function(t){var n=this._ctx;return this._read(function(t,e,r){W&&t([i(n)]);var u=[];o(n,function(t){u.push(t)},function(){t(u)},e,r)},t)},offset:function(n){var e=this._ctx;return 0>=n?this:(e.offset+=n,e.or||e.algorithm||e.filter?t(e,function(t,e,r){return--n<0}):t(e,function(t,e,r){return 0===n?!0:1===n?(--n,!1):(e(function(){t.advance(n),n=0}),!1)}),this)},limit:function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),t(this._ctx,function(t,e,r){return--n<=0&&e(r),n>=0}),this},until:function(n,e){var r=this._ctx;return W&&n(i(r)),t(this._ctx,function(t,r,o){return n(t.value)?(r(o),e):!0}),this},first:function(t){return this.limit(1).toArray(function(t){return t[0]}).then(t)},last:function(t){return this.reverse().first(t)},and:function(e){return W&&e(i(this._ctx)),t(this._ctx,function(t){return e(t.value)}),n(this._ctx,e),this},or:function(t){return new H(this._ctx.table,t,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(t){var n=this._ctx;return W&&t(S(i(this._ctx),this._ctx.index?this._ctx.table.schema.idxByName[this._ctx.index].keyPath:this._ctx.table.schema.primKey.keyPath)),n.isPrimKey||(n.op="openKeyCursor"),this.each(function(n,e){t(e.key,e)})},eachUniqueKey:function(t){return this._ctx.unique="unique",this.eachKey(t)},keys:function(t){var n=this._ctx;n.isPrimKey||(n.op="openKeyCursor");var e=[];return W?new U(this.eachKey.bind(this)).then(function(t){return[t]}).then(t):this.each(function(t,n){e.push(n.key)}).then(function(){return e}).then(t)},uniqueKeys:function(t){return this._ctx.unique="unique",this.keys(t)},firstKey:function(t){return this.limit(1).keys(function(t){return t[0]}).then(t)},lastKey:function(t){return this.reverse().firstKey(t)},distinct:function(){var n={};return t(this._ctx,function(t){var e=t.primaryKey.toString(),r=n.hasOwnProperty(e);return n[e]=!0,!r}),this}}}),i(X).from(Y).extend({modify:function(t){var n=this,e=this._ctx,o=e.table.hook,i=o.updating.fire,u=o.deleting.fire;return W&&"function"==typeof t&&t.call({value:e.table.schema.instanceTemplate},e.table.schema.instanceTemplate),this._write(function(o,c,s,f){function l(t,n,r){P=n.primaryKey;var o={primKey:n.primaryKey,value:t};if(p.call(o,t)!==!1){var i=!o.hasOwnProperty("value"),u=i?n["delete"]():n.update(o.value);++g,u.onerror=C(function(t){return w.push(t),x.push(o.primKey),o.onerror&&o.onerror(t),d(),!0},i?["deleting",t,"from",e.table.name]:["modifying",t,"on",e.table.name]),u.onsuccess=function(t){o.onsuccess&&o.onsuccess(o.value),++b,d()}}else o.onsuccess&&o.onsuccess(o.value)}function h(t){return t&&(w.push(t),x.push(P)),c(new M("Error modifying one or more objects",w,b,x))}function d(){_&&b+w.length===g&&(w.length>0?h():o(b))}var p;if("function"==typeof t)p=i===a&&u===a?t:function(n){var e=D(n);if(t.call(this,n)===!1)return!1;if(this.hasOwnProperty("value")){var r=T(e,this.value),o=i.call(this,r,this.primKey,e,f);o&&(n=this.value,Object.keys(o).forEach(function(t){k(n,t,o[t])}))}else u.call(this,this.primKey,n,f)};else if(i===a){var v=Object.keys(t),y=v.length;p=function(n){for(var e=!1,r=0;y>r;++r){var o=v[r],i=t[o];S(n,o)!==i&&(k(n,o,i),e=!0)}return e}}else{var m=t;t=O(m),p=function(n){var e=!1,o=i.call(this,t,this.primKey,D(n),f);return o&&r(t,o),Object.keys(t).forEach(function(r){var o=t[r];S(n,r)!==o&&(k(n,r,o),e=!0)}),o&&(t=O(m)),e}}var g=0,b=0,_=!1,w=[],x=[],P=null;n._iterate(l,function(){_=!0,d()},h,s)})},"delete":function(){return this.modify(function(){delete this.value})}}),r(this,{Collection:Y,Table:G,Transaction:z,Version:l,WhereClause:H,WriteableCollection:X,WriteableTable:J}),o(),st.forEach(function(t){t(Ot)})}function a(){}function s(t){return t}function f(t,n){return t===s?n:function(e){return n(t(e))}}function l(t,n){return function(){t.apply(this,arguments),n.apply(this,arguments)}}function h(t,n){return t===a?n:function(){var r=t.apply(this,arguments);r!==e&&(arguments[0]=r);var o=this.onsuccess,i=this.onerror;delete this.onsuccess,delete this.onerror;var u=n.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?l(o,this.onsuccess):o),i&&(this.onerror=this.onerror?l(i,this.onerror):i),u!==e?u:r}}function d(t,n){return t===a?n:function(){var o=t.apply(this,arguments);o!==e&&r(arguments[0],o);var i=this.onsuccess,u=this.onerror;delete this.onsuccess,delete this.onerror;var c=n.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?l(i,this.onsuccess):i),u&&(this.onerror=this.onerror?l(u,this.onerror):u),o===e?c===e?e:c:c===e?o:r(o,c)}}function p(t,n){return t===a?n:function(){return t.apply(this,arguments)===!1?!1:n.apply(this,arguments)}}function v(t,n){return t===a?n:function(){return n.apply(this,arguments)===!1?!1:t.apply(this,arguments)}}function y(t,n){return t===a?n:function(){t.apply(this,arguments),n.apply(this,arguments)}}function m(t,n){return t===a?n:function(){var e=t.apply(this,arguments);if(e&&"function"==typeof e.then){var r=this,o=arguments;return e.then(function(){return n.apply(r,o)})}return n.apply(this,arguments)}}function g(n,e){function r(t,n,e){if(Array.isArray(t))return i(t);if("object"==typeof t)return o(t);n||(n=p),e||(e=a);var r={subscribers:[],fire:e,subscribe:function(t){r.subscribers.push(t),r.fire=n(r.fire,t)},unsubscribe:function(t){r.subscribers=r.subscribers.filter(function(n){return n!==t}),r.fire=r.subscribers.reduce(n,e)}};return c[t]=s[t]=r,r}function o(n){Object.keys(n).forEach(function(e){var o=n[e];if(Array.isArray(o))r(e,n[e][0],n[e][1]);else{if("asap"!==o)throw new Error("Invalid event config");var i=r(e,null,function(){var n=arguments;i.subscribers.forEach(function(e){_(function(){e.apply(t,n)})})});i.subscribe=function(t){-1===i.subscribers.indexOf(t)&&i.subscribers.push(t)},i.unsubscribe=function(t){var n=i.subscribers.indexOf(t);-1!==n&&i.subscribers.splice(n,1)}}})}function i(t){function n(){return e?!1:void(e=!0)}var e=!1;t.forEach(function(t){r(t).subscribe(n)})}var u=arguments,c={},s=function(t,e){if(e){var r=[].slice.call(arguments,1),o=c[t];return o.subscribe.apply(o,r),n}return"string"==typeof t?c[t]:void 0};s.addEventType=r;for(var f=1,l=u.length;l>f;++f)r(u[f]);return s}function b(t){if(!t)throw new Error("Assertion failed")}function _(n){t.setImmediate?o(n):setTimeout(n,0)}function w(t){var n=setTimeout(t,1e3);clearTimeout(n)}function x(t,n,e){return function(){var r=U.PSD;U.PSD=e;try{t.apply(this,arguments)}catch(o){n(o)}finally{U.PSD=r}}}function S(t,n){if(t.hasOwnProperty(n))return t[n];if(!n)return t;if("string"!=typeof n){for(var r=[],o=0,i=n.length;i>o;++o){var u=S(t,n[o]);r.push(u)}return r}var c=n.indexOf(".");if(-1!==c){var a=t[n.substr(0,c)];return a===e?e:S(a,n.substr(c+1))}return e}function k(t,n,r){if(t&&n!==e)if("string"!=typeof n&&"length"in n){b("string"!=typeof r&&"length"in r);for(var o=0,i=n.length;i>o;++o)k(t,n[o],r[o])}else{var u=n.indexOf(".");if(-1!==u){var c=n.substr(0,u),a=n.substr(u+1);if(""===a)r===e?delete t[c]:t[c]=r;else{var s=t[c];s||(s=t[c]={}),k(s,a,r)}}else r===e?delete t[n]:t[n]=r}}function P(t,n){"string"==typeof n?k(t,n,e):"length"in n&&[].map.call(n,function(n){k(t,n,e)})}function O(t){var n={};for(var e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function D(t){if(!t||"object"!=typeof t)return t;var n;if(Array.isArray(t)){n=[];for(var e=0,r=t.length;r>e;++e)n.push(D(t[e]))}else if(t instanceof Date)n=new Date,n.setTime(t.getTime());else{n=t.constructor?Object.create(t.constructor.prototype):{};for(var o in t)t.hasOwnProperty(o)&&(n[o]=D(t[o]))}return n}function T(t,n){var r={};for(var o in t)t.hasOwnProperty(o)&&(n.hasOwnProperty(o)?t[o]!==n[o]&&JSON.stringify(t[o])!=JSON.stringify(n[o])&&(r[o]=n[o]):r[o]=e);for(var o in n)n.hasOwnProperty(o)&&!t.hasOwnProperty(o)&&(r[o]=n[o]);return r}function E(t){if("function"==typeof t)return new t;if(Array.isArray(t))return[E(t[0])];if(t&&"object"==typeof t){var n={};return j(n,t),n}return t}function j(t,n){Object.keys(n).forEach(function(e){var r=E(n[e]);t[e]=r})}function C(t,n){return function(e){var r=e&&e.target.error||new Error;if(n){var o=" occurred when "+n.map(function(t){switch(typeof t){case"function":return t();case"string":return t;default:return JSON.stringify(t)}}).join(" ");r.name?r.toString=function(){return r.name+o+(r.message?". "+r.message:"")}:r+=o}return t(r),e&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()),!1}}function I(t){try{throw t}catch(n){return n}}function A(t){t.preventDefault()}function N(t){var n,e=c.dependencies.localStorage;if(!e)return t([]);try{n=JSON.parse(e.getItem("Dexie.DatabaseNames")||"[]")}catch(r){n=[]}t(n)&&e.setItem("Dexie.DatabaseNames",JSON.stringify(n))}function F(t,n,e,r,o,i,u){this.name=t,this.keyPath=n,this.unique=e,this.multi=r,this.auto=o,this.compound=i,this.dotted=u;var c="string"==typeof n?n:n&&"["+[].join.call(n,"+")+"]";this.src=(e?"&":"")+(r?"*":"")+(o?"++":"")+c}function K(t,n,e,r){this.name=t,this.primKey=n||new F,this.indexes=e||[new F],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=e.reduce(function(t,n){return t[n.name]=n,t},{})}function M(t,n,e,r){this.name="ModifyError",this.failures=n,this.failedKeys=r,this.successCount=e,this.message=n.join("\n")}function B(t){return 1===t.length?t[0]:t}function R(){var t=c.dependencies.indexedDB,n=t&&(t.getDatabaseNames||t.webkitGetDatabaseNames);return n&&n.bind(t)}var U=function(){function n(t,n){b.push([t,p.call(arguments,1)])}function e(){var n=b;b=[];for(var e=0,r=n.length;r>e;++e){var o=n[e];o[0].apply(t,o[1])}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],this._catched=!1;var n=this,e=!0;this._PSD=r.PSD;try{d(this,t,function(t){e?y(s,n,t):s(n,t)},function(t){return e?(y(f,n,t),!1):f(n,t)})}finally{e=!1}}function i(t,o){if(null===t._state)return void t._deferreds.push(o);var i=t._state?o.onFulfilled:o.onRejected;if(null===i)return(t._state?o.resolve:o.reject)(t._value);var u,a=m;m=!1,y=n;try{var s=r.PSD;r.PSD=t._PSD,u=i(t._value),t._state||u&&"function"==typeof u.then&&u._state===!1||c(t),o.resolve(u)}catch(f){var l=o.reject(f);if(!l&&t.onuncatched)try{t.onuncatched(f)}catch(f){}}finally{if(r.PSD=s,a){do{for(;b.length>0;)e();var h=_.pop();if(h)try{h()}catch(f){}}while(_.length>0||b.length>0);y=v,m=!0}}}function u(t){var r=m;m=!1,y=n;try{t()}finally{if(r){do{for(;b.length>0;)e();var o=_.pop();if(o)try{o()}catch(i){}}while(_.length>0||b.length>0);y=v,m=!0}}}function c(t){t._catched=!0,t._parent&&c(t._parent)}function s(t,n){var e=r.PSD;r.PSD=t._PSD;try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)&&"function"==typeof n.then)return void d(t,function(t,e){n.then(t,e)},function(n){s(t,n)},function(n){f(t,n)});t._state=!0,t._value=n,l.call(t)}catch(o){f(o)}finally{r.PSD=e}}function f(t,n){var e=r.PSD;if(r.PSD=t._PSD,t._state=!1,t._value=n,l.call(t),!t._catched)try{t.onuncatched&&t.onuncatched(t._value),r.on.error.fire(t._value)}catch(o){}return r.PSD=e,t._catched}function l(){for(var t=0,n=this._deferreds.length;n>t;t++)i(this,this._deferreds[t]);this._deferreds=[]}function h(t,n,e,r){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.resolve=e,this.reject=r}function d(t,n,e,r){var o=!1;try{n(function(t){o||(o=!0,e(t))},function(n){return o?t._catched:(o=!0,r(n))})}catch(i){if(o)return;return r(i)}}var p=[].slice,v="undefined"==typeof o?function(n,e,r,o){var i=arguments;setTimeout(function(){n.apply(t,p.call(i,1))},0)}:o;w(function(){v=y=n=function(n){var e=arguments;setTimeout(function(){n.apply(t,p.call(e,1))},0)}});var y=v,m=!0,b=[],_=[];return r.on=g(null,"error"),r.all=function(){var t=Array.prototype.slice.call(1===arguments.length&&Array.isArray(arguments[0])?arguments[0]:arguments);return new r(function(n,e){function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var c=u.then;if("function"==typeof c)return void c.call(u,function(t){r(i,t)},e)}t[i]=u,0===--o&&n(t)}catch(a){e(a)}}if(0===t.length)return n([]);for(var o=t.length,i=0;i<t.length;i++)r(i,t[i])})},r.prototype.then=function(t,n){var e=this,o=new r(function(r,o){null===e._state?i(e,new h(t,n,r,o)):y(i,e,new h(t,n,r,o))});return o._PSD=this._PSD,o.onuncatched=this.onuncatched,o._parent=this,o},r.prototype._then=function(t,n){i(this,new h(t,n,a,a))},r.prototype["catch"]=function(t){if(1===arguments.length)return this.then(null,t);var n=arguments[0],e=arguments[1];return"function"==typeof n?this.then(null,function(t){return t instanceof n?e(t):r.reject(t)}):this.then(null,function(t){return t&&t.name===n?e(t):r.reject(t)})},r.prototype["finally"]=function(t){return this.then(function(n){return t(),n},function(n){return t(),r.reject(n)})},r.prototype.onuncatched=null,r.resolve=function(t){var n=new r(function(){});return n._state=!0,n._value=t,n},r.reject=function(t){var n=new r(function(){});return n._state=!1,n._value=t,n},r.race=function(t){return new r(function(n,e){t.map(function(t){t.then(n,e)})})},r.PSD=null,r.newPSD=function(t){var n=r.PSD;r.PSD=n?Object.create(n):{};try{return t()}finally{r.PSD=n}},r._rootExec=u,r._tickFinalize=function(t){if(m)throw new Error("Not in a virtual tick");_.push(t)},r}(),q=function(){},W=!1;i(M).from(Error),c["delete"]=function(t){var n=new c(t),e=n["delete"]();return e.onblocked=function(t){return n.on("blocked",t),this},e},c.exists=function(t){return new c(t).open().then(function(t){return t.close(),!0},function(){return!1})},c.getDatabaseNames=function(t){return new U(function(t,n){var e=R();if(e){var r=e();r.onsuccess=function(n){t([].slice.call(n.target.result,0))},r.onerror=C(n)}else N(function(n){return t(n),!1})}).then(t)},c.defineClass=function(t){function n(n){n?r(this,n):W&&j(this,t)}return n},c.ignoreTransaction=function(t){return U.newPSD(function(){return U.PSD.trans=null,t()})},c.spawn=function(){return t.console&&console.warn("Dexie.spawn() is deprecated. Use Dexie.ignoreTransaction() instead."),c.ignoreTransaction.apply(this,arguments)},c.vip=function(t){return U.newPSD(function(){return U.PSD.letThrough=!0,t()})},Object.defineProperty(c,"currentTransaction",{get:function(){return U.PSD&&U.PSD.trans||null}}),c.Promise=U,c.derive=i,c.extend=r,c.override=u,c.events=g,c.getByKeyPath=S,c.setByKeyPath=k,c.delByKeyPath=P,c.shallowClone=O,c.deepClone=D,c.addons=[],c.fakeAutoComplete=q,c.asap=_,c.ModifyError=M,c.MultiModifyError=M,c.IndexSpec=F,c.TableSchema=K;var L=t.idbModules&&t.idbModules.shimIndexedDB?t.idbModules:{};c.dependencies={indexedDB:L.shimIndexedDB||t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB,IDBKeyRange:L.IDBKeyRange||t.IDBKeyRange||t.webkitIDBKeyRange,IDBTransaction:L.IDBTransaction||t.IDBTransaction||t.webkitIDBTransaction,Error:t.Error||String,SyntaxError:t.SyntaxError||String,TypeError:t.TypeError||String,DOMError:t.DOMError||String,localStorage:null!=("undefined"!=typeof chrome&&null!==chrome?chrome.storage:void 0)?null:t.localStorage},c.version=1.2,n("Dexie",c),w(function(){c.fakeAutoComplete=q=w,c.fake=W=!0})}).apply(null,[self||window,function(o,i){r=function(){return i}.call(n,e,n,t),!(void 0!==r&&(t.exports=r))}])}).call(n,e(18).setImmediate)},function(t,n){function e(){s=!1,u.length?a=u.concat(a):f=-1,a.length&&r()}function r(){if(!s){var t=setTimeout(e);s=!0;for(var n=a.length;n;){for(u=a,a=[];++f<n;)u&&u[f].run();f=-1,n=a.length}u=null,s=!1,clearTimeout(t)}}function o(t,n){this.fun=t,this.array=n}function i(){}var u,c=t.exports={},a=[],s=!1,f=-1;c.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)n[e-1]=arguments[e];a.push(new o(t,n)),1!==a.length||s||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},c.title="browser",c.browser=!0,c.env={},c.argv=[],c.version="",c.versions={},c.on=i,c.addListener=i,c.once=i,c.off=i,c.removeListener=i,c.removeAllListeners=i,c.emit=i,c.binding=function(t){throw new Error("process.binding is not supported")},c.cwd=function(){return"/"},c.chdir=function(t){throw new Error("process.chdir is not supported")},c.umask=function(){return 0}}]);