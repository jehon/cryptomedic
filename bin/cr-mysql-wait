#!/usr/bin/env bash

set -o errexit
set -o pipefail

. "$(realpath "$(dirname "${BASH_SOURCE[0]}")")"/cr-lib

mysql_test() {
    # Do not capture stdin!
    bin/cr-mysqladmin ping -h "localhost" --silent >/dev/null </dev/null
}

sleep 1s
log_progress "Waiting for mysql"
sleep 0.5s
while ! mysql_test; do
    log_progress
    sleep 0.5s
done
log_progress " âœ“\n"
