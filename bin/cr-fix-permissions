#!/usr/bin/env bash

set -e

. cr-lib

FOLDER="$1"
if [ -z "$FOLDER" ]; then
    FOLDER="."
fi

USERUID="$(id -u)"

header "Fixing permission through 'dev' to $USERUID on $FOLDER"
docker-compose run --rm "dev" \
    find "$FOLDER" \( -not -user "${USERUID}" \) -exec chown "${USERUID}" '{}' ';'
header_finished

header "Fixing permission a+rwx on specific folders"
docker-compose run --rm "dev" \
    chmod a+rwX www/api/v1.3/storage/framework/cache/cache.php
header_finished
