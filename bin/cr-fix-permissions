#!/usr/bin/env bash

set -o errexit
set -o pipefail

# shellcheck source=./cr-lib
. "$(dirname "${BASH_SOURCE[0]}")"/cr-lib

FOLDER="${1:-.}"
if [ -r "$FOLDER" ]; then
    USERUID="$(id -u)"
    header "Fixing permission through 'dev' to $USERUID on $FOLDER"
    cr-docker-compose run --rm \
        "dev" \
        find "$FOLDER" \( -not -user "${USERUID}" \) -exec chown "${USERUID}" '{}' ';'
    header_end
fi
