#!/usr/bin/env bash

set -o errexit
set -o pipefail

# shellcheck source=/dev/null
if [ -x "$1" ]; then
    . "$1"
fi
shift

export CRYPTOMEDIC_DEPLOY_HOST="${CRYPTOMEDIC_DEPLOY_HOST:-$JH_CRYPTOMEDIC_DEPLOY_HOST}"
export CRYPTOMEDIC_HTTP_HOST="www.cryptomedic.org"
export CRYPTOMEDIC_HTTP_PORT=80

export CRYPTOMEDIC_DEPLOY_USER="${CRYPTOMEDIC_DEPLOY_USER:-$JH_CRYPTOMEDIC_DEPLOY_USER}"
export CRYPTOMEDIC_DEPLOY_PASSWORD="${CRYPTOMEDIC_DEPLOY_PASSWORD:-$JH_CRYPTOMEDIC_DEPLOY_PASSWORD}"
export CRYPTOMEDIC_WEB_TOKEN="${CRYPTOMEDIC_WEB_TOKEN:-$JH_CRYPTOMEDIC_WEB_TOKEN}"

test_param() {
    if [ -z "${!1}" ]; then
        echo "Missing $1"
        exit 255
    fi
}

test_param "CRYPTOMEDIC_DEPLOY_USER"
test_param "CRYPTOMEDIC_DEPLOY_PASSWORD"
test_param "CRYPTOMEDIC_DEPLOY_HOST"
test_param "CRYPTOMEDIC_HTTP_HOST"
test_param "CRYPTOMEDIC_HTTP_PORT"
test_param "CRYPTOMEDIC_WEB_TOKEN"

echo "Parameters ok"
