#!/usr/bin/env bash

set -o errexit
set -o pipefail

# shellcheck source=./cr-lib
. "$(dirname "${BASH_SOURCE[0]}")"/cr-lib

OUTPUT="$CR_TMP/$CR_DB_NAME"

cr-ensure-started
mkdir -p "$(dirname "$OUTPUT")"

(
    cr-docker-compose exec -T \
        "mysql" \
        mysqldump -u root -p"$CR_DB_ROOT_PASS" "$CR_DB_NAME"

) >"$OUTPUT"

echo
echo "Backup available at $OUTPUT"
