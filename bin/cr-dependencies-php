#!/usr/bin/env bash

set -o errexit
set -o pipefail

# shellcheck source=./cr-lib
. "$(dirname "${BASH_SOURCE[0]}")"/cr-lib

FOLDER="$1"
ACT="${2:-install}"

header_begin "Installing dependencies in $FOLDER ($ACT)"
(cd "$FOLDER" && cr-capture-output cr-composer "$ACT")
cr-fix-permissions "$FOLDER/vendor"
cr-fix-permissions "$FOLDER/composer.lock"
touch "$FOLDER"/composer.lock
header_end
