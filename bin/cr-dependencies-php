#!/usr/bin/env bash

set -e

. cr-lib

FOLDER="$1"
ACT="install"
if [ -n "$2" ]; then
    ACT="$2"
fi

header "Installing dependencies in $FOLDER"
cr_capture_output docker-compose run --rm  --workdir "/app/$FOLDER" "php" "/composer.phar" "$ACT"
cr-fix-permissions "$FOLDER/vendor"
cr_capture_output touch "$FOLDER"/composer.lock
cr_capture_output touch "$FOLDER"/vendor/.dependencies
header_finished
